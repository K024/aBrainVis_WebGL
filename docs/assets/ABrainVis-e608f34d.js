var An=Object.defineProperty;var En=(l,t,h)=>t in l?An(l,t,{enumerable:!0,configurable:!0,writable:!0,value:h}):l[t]=h;var vt=(l,t,h)=>(En(l,typeof t!="symbol"?t+"":t,h),h);import{r as Ie,_ as ln,d as sr,u as Mn,j as Pn,b as fr}from"./index-70c34284.js";import{u as Bn,m as Ln,U as Gn,M as Rn,R as On,a as In,S as Wn,b as Tt,F as Nn,C as Hr,V as Yr,T as zn,L as Yt,I as Vn,c as jn,B as Xn,d as Yn,D as un,e as Hn,f as Ht,g as Jn,h as Kn,i as Qn,j as Jr,P as xt,k as cn,l as Zn,n as qn,s as $n,o as ea,p as ra,q as ta,r as na}from"./Scene-1768c244.js";function aa(l,t="pointer",h="auto"){Ie.useEffect(()=>{if(l)return document.body.style.cursor=t,()=>void(document.body.style.cursor=h)},[l])}const oa=Ie.forwardRef(function({follow:t=!0,lockX:h=!1,lockY:u=!1,lockZ:r=!1,...e},o){const a=Ie.useRef();return Bn(({camera:n})=>{if(!t||!a.current)return;const i=a.current.rotation.clone();a.current.quaternion.copy(n.quaternion),h&&(a.current.rotation.x=i.x),u&&(a.current.rotation.y=i.y),r&&(a.current.rotation.z=i.z)}),Ie.createElement("group",ln({ref:Ln([a,o])},e))});function ia(){var l=Object.create(null);function t(r,e){var o=r.id,a=r.name,n=r.dependencies;n===void 0&&(n=[]);var i=r.init;i===void 0&&(i=function(){});var s=r.getTransferables;if(s===void 0&&(s=null),!l[o])try{n=n.map(function(c){return c&&c.isWorkerModule&&(t(c,function(d){if(d instanceof Error)throw d}),c=l[c.id].value),c}),i=u("<"+a+">.init",i),s&&(s=u("<"+a+">.getTransferables",s));var f=null;typeof i=="function"?f=i.apply(void 0,n):console.error("worker module init function failed to rehydrate"),l[o]={id:o,value:f,getTransferables:s},e(f)}catch(c){c&&c.noLog||console.error(c),e(c)}}function h(r,e){var o,a=r.id,n=r.args;(!l[a]||typeof l[a].value!="function")&&e(new Error("Worker module "+a+": not found or its 'init' did not return a function"));try{var i=(o=l[a]).value.apply(o,n);i&&typeof i.then=="function"?i.then(s,function(f){return e(f instanceof Error?f:new Error(""+f))}):s(i)}catch(f){e(f)}function s(f){try{var c=l[a].getTransferables&&l[a].getTransferables(f);(!c||!Array.isArray(c)||!c.length)&&(c=void 0),e(f,c)}catch(d){console.error(d),e(d)}}}function u(r,e){var o=void 0;self.troikaDefine=function(n){return o=n};var a=URL.createObjectURL(new Blob(["/** "+r.replace(/\*/g,"")+` **/

troikaDefine(
`+e+`
)`],{type:"application/javascript"}));try{importScripts(a)}catch(n){console.error(n)}return URL.revokeObjectURL(a),delete self.troikaDefine,o}self.addEventListener("message",function(r){var e=r.data,o=e.messageId,a=e.action,n=e.data;try{a==="registerModule"&&t(n,function(i){i instanceof Error?postMessage({messageId:o,success:!1,error:i.message}):postMessage({messageId:o,success:!0,result:{isCallable:typeof i=="function"}})}),a==="callModule"&&h(n,function(i,s){i instanceof Error?postMessage({messageId:o,success:!1,error:i.message}):postMessage({messageId:o,success:!0,result:i},s||void 0)})}catch(i){postMessage({messageId:o,success:!1,error:i.stack})}})}function sa(l){var t=function(){for(var h=[],u=arguments.length;u--;)h[u]=arguments[u];return t._getInitResult().then(function(r){if(typeof r=="function")return r.apply(void 0,h);throw new Error("Worker module function was called but `init` did not return a callable function")})};return t._getInitResult=function(){var h=l.dependencies,u=l.init;h=Array.isArray(h)?h.map(function(e){return e&&e._getInitResult?e._getInitResult():e}):[];var r=Promise.all(h).then(function(e){return u.apply(null,e)});return t._getInitResult=function(){return r},r},t}var dn=function(){var l=!1;if(typeof window<"u"&&typeof window.document<"u")try{var t=new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"})));t.terminate(),l=!0}catch(h){typeof process<"u",console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+h.message+"]")}return dn=function(){return l},l},fa=0,la=0,pt=!1,wr=Object.create(null),Tr=Object.create(null),Ut=Object.create(null);function xr(l){if((!l||typeof l.init!="function")&&!pt)throw new Error("requires `options.init` function");var t=l.dependencies,h=l.init,u=l.getTransferables,r=l.workerId;if(!dn())return sa(l);r==null&&(r="#default");var e="workerModule"+ ++fa,o=l.name||e,a=null;t=t&&t.map(function(i){return typeof i=="function"&&!i.workerModuleData&&(pt=!0,i=xr({workerId:r,name:"<"+o+"> function dependency: "+i.name,init:`function(){return (
`+jr(i)+`
)}`}),pt=!1),i&&i.workerModuleData&&(i=i.workerModuleData),i});function n(){for(var i=[],s=arguments.length;s--;)i[s]=arguments[s];if(!a){a=Jt(r,"registerModule",n.workerModuleData);var f=function(){a=null,Tr[r].delete(f)};(Tr[r]||(Tr[r]=new Set)).add(f)}return a.then(function(c){var d=c.isCallable;if(d)return Jt(r,"callModule",{id:e,args:i});throw new Error("Worker module function was called but `init` did not return a callable function")})}return n.workerModuleData={isWorkerModule:!0,id:e,name:o,dependencies:t,init:jr(h),getTransferables:u&&jr(u)},n}function ua(l){Tr[l]&&Tr[l].forEach(function(t){t()}),wr[l]&&(wr[l].terminate(),delete wr[l])}function jr(l){var t=l.toString();return!/^function/.test(t)&&/^\w+\s*\(/.test(t)&&(t="function "+t),t}function ca(l){var t=wr[l];if(!t){var h=jr(ia);t=wr[l]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+l.replace(/\*/g,"")+` **/

;(`+h+")()"],{type:"application/javascript"}))),t.onmessage=function(u){var r=u.data,e=r.messageId,o=Ut[e];if(!o)throw new Error("WorkerModule response with empty or unknown messageId");delete Ut[e],o(r)}}return t}function Jt(l,t,h){return new Promise(function(u,r){var e=++la;Ut[e]=function(o){o.success?u(o.result):r(new Error("Error in worker "+t+" call: "+o.error))},ca(l).postMessage({messageId:e,action:t,data:h})})}function hn(){var l=function(t){function h(P,W,p,x,G,L,D,I){var C=1-D;I.x=C*C*P+2*C*D*p+D*D*G,I.y=C*C*W+2*C*D*x+D*D*L}function u(P,W,p,x,G,L,D,I,C,M){var z=1-C;M.x=z*z*z*P+3*z*z*C*p+3*z*C*C*G+C*C*C*D,M.y=z*z*z*W+3*z*z*C*x+3*z*C*C*L+C*C*C*I}function r(P,W){for(var p=/([MLQCZ])([^MLQCZ]*)/g,x,G,L,D,I;x=p.exec(P);){var C=x[2].replace(/^\s*|\s*$/g,"").split(/[,\s]+/).map(function(M){return parseFloat(M)});switch(x[1]){case"M":D=G=C[0],I=L=C[1];break;case"L":(C[0]!==D||C[1]!==I)&&W("L",D,I,D=C[0],I=C[1]);break;case"Q":{W("Q",D,I,D=C[2],I=C[3],C[0],C[1]);break}case"C":{W("C",D,I,D=C[4],I=C[5],C[0],C[1],C[2],C[3]);break}case"Z":(D!==G||I!==L)&&W("L",D,I,G,L);break}}}function e(P,W,p){p===void 0&&(p=16);var x={x:0,y:0};r(P,function(G,L,D,I,C,M,z,q,V){switch(G){case"L":W(L,D,I,C);break;case"Q":{for(var E=L,he=D,ce=1;ce<p;ce++)h(L,D,M,z,I,C,ce/(p-1),x),W(E,he,x.x,x.y),E=x.x,he=x.y;break}case"C":{for(var X=L,$=D,fe=1;fe<p;fe++)u(L,D,M,z,q,V,I,C,fe/(p-1),x),W(X,$,x.x,x.y),X=x.x,$=x.y;break}}})}var o="precision highp float;attribute vec2 aUV;varying vec2 vUV;void main(){vUV=aUV;gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",a="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){gl_FragColor=texture2D(tex,vUV);}",n=new WeakMap,i={premultipliedAlpha:!1,preserveDrawingBuffer:!0,antialias:!1,depth:!1};function s(P,W){var p=P.getContext?P.getContext("webgl",i):P,x=n.get(p);if(!x){let z=function(X){var $=L[X];if(!$&&($=L[X]=p.getExtension(X),!$))throw new Error(X+" not supported");return $},q=function(X,$){var fe=p.createShader($);return p.shaderSource(fe,X),p.compileShader(fe),fe},V=function(X,$,fe,R){if(!D[X]){var re={},H={},B=p.createProgram();p.attachShader(B,q($,p.VERTEX_SHADER)),p.attachShader(B,q(fe,p.FRAGMENT_SHADER)),p.linkProgram(B),D[X]={program:B,transaction:function(Q){p.useProgram(B),Q({setUniform:function(J,me){for(var pe=[],ee=arguments.length-2;ee-- >0;)pe[ee]=arguments[ee+2];var ue=H[me]||(H[me]=p.getUniformLocation(B,me));p["uniform"+J].apply(p,[ue].concat(pe))},setAttribute:function(J,me,pe,ee,ue){var ge=re[J];ge||(ge=re[J]={buf:p.createBuffer(),loc:p.getAttribLocation(B,J),data:null}),p.bindBuffer(p.ARRAY_BUFFER,ge.buf),p.vertexAttribPointer(ge.loc,me,p.FLOAT,!1,0,0),p.enableVertexAttribArray(ge.loc),G?p.vertexAttribDivisor(ge.loc,ee):z("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(ge.loc,ee),ue!==ge.data&&(p.bufferData(p.ARRAY_BUFFER,ue,pe),ge.data=ue)}})}}}D[X].transaction(R)},E=function(X,$){C++;try{p.activeTexture(p.TEXTURE0+C);var fe=I[X];fe||(fe=I[X]=p.createTexture(),p.bindTexture(p.TEXTURE_2D,fe),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.NEAREST),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.NEAREST)),p.bindTexture(p.TEXTURE_2D,fe),$(fe,C)}finally{C--}},he=function(X,$,fe){var R=p.createFramebuffer();M.push(R),p.bindFramebuffer(p.FRAMEBUFFER,R),p.activeTexture(p.TEXTURE0+$),p.bindTexture(p.TEXTURE_2D,X),p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,p.TEXTURE_2D,X,0);try{fe(R)}finally{p.deleteFramebuffer(R),p.bindFramebuffer(p.FRAMEBUFFER,M[--M.length-1]||null)}},ce=function(){L={},D={},I={},C=-1,M.length=0};var G=typeof WebGL2RenderingContext<"u"&&p instanceof WebGL2RenderingContext,L={},D={},I={},C=-1,M=[];p.canvas.addEventListener("webglcontextlost",function(X){ce(),X.preventDefault()},!1),n.set(p,x={gl:p,isWebGL2:G,getExtension:z,withProgram:V,withTexture:E,withTextureFramebuffer:he,handleContextLoss:ce})}W(x)}function f(P,W,p,x,G,L,D,I){D===void 0&&(D=15),I===void 0&&(I=null),s(P,function(C){var M=C.gl,z=C.withProgram,q=C.withTexture;q("copy",function(V,E){M.texImage2D(M.TEXTURE_2D,0,M.RGBA,G,L,0,M.RGBA,M.UNSIGNED_BYTE,W),z("copy",o,a,function(he){var ce=he.setUniform,X=he.setAttribute;X("aUV",2,M.STATIC_DRAW,0,new Float32Array([0,0,2,0,0,2])),ce("1i","image",E),M.bindFramebuffer(M.FRAMEBUFFER,I||null),M.disable(M.BLEND),M.colorMask(D&8,D&4,D&2,D&1),M.viewport(p,x,G,L),M.scissor(p,x,G,L),M.drawArrays(M.TRIANGLES,0,3)})})})}function c(P,W,p){var x=P.width,G=P.height;s(P,function(L){var D=L.gl,I=new Uint8Array(x*G*4);D.readPixels(0,0,x,G,D.RGBA,D.UNSIGNED_BYTE,I),P.width=W,P.height=p,f(D,I,0,0,x,G)})}var d=Object.freeze({__proto__:null,withWebGLContext:s,renderImageData:f,resizeWebGLCanvasWithoutClearing:c});function y(P,W,p,x,G,L){L===void 0&&(L=1);var D=new Uint8Array(P*W),I=x[2]-x[0],C=x[3]-x[1],M=[];e(p,function(X,$,fe,R){M.push({x1:X,y1:$,x2:fe,y2:R,minX:Math.min(X,fe),minY:Math.min($,R),maxX:Math.max(X,fe),maxY:Math.max($,R)})}),M.sort(function(X,$){return X.maxX-$.maxX});for(var z=0;z<P;z++)for(var q=0;q<W;q++){var V=he(x[0]+I*(z+.5)/P,x[1]+C*(q+.5)/W),E=Math.pow(1-Math.abs(V)/G,L)/2;V<0&&(E=1-E),E=Math.max(0,Math.min(255,Math.round(E*255))),D[q*P+z]=E}return D;function he(X,$){for(var fe=1/0,R=1/0,re=M.length;re--;){var H=M[re];if(H.maxX+R<=X)break;if(X+R>H.minX&&$-R<H.maxY&&$+R>H.minY){var B=S(X,$,H.x1,H.y1,H.x2,H.y2);B<fe&&(fe=B,R=Math.sqrt(fe))}}return ce(X,$)&&(R=-R),R}function ce(X,$){for(var fe=0,R=M.length;R--;){var re=M[R];if(re.maxX<=X)break;var H=re.y1>$!=re.y2>$&&X<(re.x2-re.x1)*($-re.y1)/(re.y2-re.y1)+re.x1;H&&(fe+=re.y1<re.y2?1:-1)}return fe!==0}}function m(P,W,p,x,G,L,D,I,C,M){L===void 0&&(L=1),I===void 0&&(I=0),C===void 0&&(C=0),M===void 0&&(M=0),g(P,W,p,x,G,L,D,null,I,C,M)}function g(P,W,p,x,G,L,D,I,C,M,z){L===void 0&&(L=1),C===void 0&&(C=0),M===void 0&&(M=0),z===void 0&&(z=0);for(var q=y(P,W,p,x,G,L),V=new Uint8Array(q.length*4),E=0;E<q.length;E++)V[E*4+z]=q[E];f(D,V,C,M,P,W,1<<3-z,I)}function S(P,W,p,x,G,L){var D=G-p,I=L-x,C=D*D+I*I,M=C?Math.max(0,Math.min(1,((P-p)*D+(W-x)*I)/C)):0,z=P-(p+M*D),q=W-(x+M*I);return z*z+q*q}var v=Object.freeze({__proto__:null,generate:y,generateIntoCanvas:m,generateIntoFramebuffer:g}),_="precision highp float;uniform vec4 uGlyphBounds;attribute vec2 aUV;attribute vec4 aLineSegment;varying vec4 vLineSegment;varying vec2 vGlyphXY;void main(){vLineSegment=aLineSegment;vGlyphXY=mix(uGlyphBounds.xy,uGlyphBounds.zw,aUV);gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",F="precision highp float;uniform vec4 uGlyphBounds;uniform float uMaxDistance;uniform float uExponent;varying vec4 vLineSegment;varying vec2 vGlyphXY;float absDistToSegment(vec2 point,vec2 lineA,vec2 lineB){vec2 lineDir=lineB-lineA;float lenSq=dot(lineDir,lineDir);float t=lenSq==0.0 ? 0.0 : clamp(dot(point-lineA,lineDir)/lenSq,0.0,1.0);vec2 linePt=lineA+t*lineDir;return distance(point,linePt);}void main(){vec4 seg=vLineSegment;vec2 p=vGlyphXY;float dist=absDistToSegment(p,seg.xy,seg.zw);float val=pow(1.0-clamp(dist/uMaxDistance,0.0,1.0),uExponent)*0.5;bool crossing=(seg.y>p.y!=seg.w>p.y)&&(p.x<(seg.z-seg.x)*(p.y-seg.y)/(seg.w-seg.y)+seg.x);bool crossingUp=crossing&&vLineSegment.y<vLineSegment.w;gl_FragColor=vec4(crossingUp ? 1.0/255.0 : 0.0,crossing&&!crossingUp ? 1.0/255.0 : 0.0,0.0,val);}",U="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){vec4 color=texture2D(tex,vUV);bool inside=color.r!=color.g;float val=inside ? 1.0-color.a : color.a;gl_FragColor=vec4(val);}",T=new Float32Array([0,0,2,0,0,2]),k=null,w=!1,Y={},K=new WeakMap;function ne(P){if(!w&&!j(P))throw new Error("WebGL generation not supported")}function b(P,W,p,x,G,L,D){if(L===void 0&&(L=1),D===void 0&&(D=null),!D&&(D=k,!D)){var I=typeof OffscreenCanvas=="function"?new OffscreenCanvas(1,1):typeof document<"u"?document.createElement("canvas"):null;if(!I)throw new Error("OffscreenCanvas or DOM canvas not supported");D=k=I.getContext("webgl",{depth:!1})}ne(D);var C=new Uint8Array(P*W*4);s(D,function(V){var E=V.gl,he=V.withTexture,ce=V.withTextureFramebuffer;he("readable",function(X,$){E.texImage2D(E.TEXTURE_2D,0,E.RGBA,P,W,0,E.RGBA,E.UNSIGNED_BYTE,null),ce(X,$,function(fe){A(P,W,p,x,G,L,E,fe,0,0,0),E.readPixels(0,0,P,W,E.RGBA,E.UNSIGNED_BYTE,C)})})});for(var M=new Uint8Array(P*W),z=0,q=0;z<C.length;z+=4)M[q++]=C[z];return M}function O(P,W,p,x,G,L,D,I,C,M){L===void 0&&(L=1),I===void 0&&(I=0),C===void 0&&(C=0),M===void 0&&(M=0),A(P,W,p,x,G,L,D,null,I,C,M)}function A(P,W,p,x,G,L,D,I,C,M,z){L===void 0&&(L=1),C===void 0&&(C=0),M===void 0&&(M=0),z===void 0&&(z=0),ne(D);var q=[];e(p,function(V,E,he,ce){q.push(V,E,he,ce)}),q=new Float32Array(q),s(D,function(V){var E=V.gl,he=V.isWebGL2,ce=V.getExtension,X=V.withProgram,$=V.withTexture,fe=V.withTextureFramebuffer,R=V.handleContextLoss;if($("rawDistances",function(re,H){(P!==re._lastWidth||W!==re._lastHeight)&&E.texImage2D(E.TEXTURE_2D,0,E.RGBA,re._lastWidth=P,re._lastHeight=W,0,E.RGBA,E.UNSIGNED_BYTE,null),X("main",_,F,function(B){var ae=B.setAttribute,Q=B.setUniform,te=!he&&ce("ANGLE_instanced_arrays"),J=!he&&ce("EXT_blend_minmax");ae("aUV",2,E.STATIC_DRAW,0,T),ae("aLineSegment",4,E.DYNAMIC_DRAW,1,q),Q.apply(void 0,["4f","uGlyphBounds"].concat(x)),Q("1f","uMaxDistance",G),Q("1f","uExponent",L),fe(re,H,function(me){E.enable(E.BLEND),E.colorMask(!0,!0,!0,!0),E.viewport(0,0,P,W),E.scissor(0,0,P,W),E.blendFunc(E.ONE,E.ONE),E.blendEquationSeparate(E.FUNC_ADD,he?E.MAX:J.MAX_EXT),E.clear(E.COLOR_BUFFER_BIT),he?E.drawArraysInstanced(E.TRIANGLES,0,3,q.length/4):te.drawArraysInstancedANGLE(E.TRIANGLES,0,3,q.length/4)})}),X("post",o,U,function(B){B.setAttribute("aUV",2,E.STATIC_DRAW,0,T),B.setUniform("1i","tex",H),E.bindFramebuffer(E.FRAMEBUFFER,I),E.disable(E.BLEND),E.colorMask(z===0,z===1,z===2,z===3),E.viewport(C,M,P,W),E.scissor(C,M,P,W),E.drawArrays(E.TRIANGLES,0,3)})}),E.isContextLost())throw R(),new Error("webgl context lost")})}function j(P){var W=!P||P===k?Y:P.canvas||P,p=K.get(W);if(p===void 0){w=!0;var x=null;try{var G=[97,106,97,61,99,137,118,80,80,118,137,99,61,97,106,97],L=b(4,4,"M8,8L16,8L24,24L16,24Z",[0,0,32,32],24,1,P);p=L&&G.length===L.length&&L.every(function(D,I){return D===G[I]}),p||(x="bad trial run results",console.info(G,L))}catch(D){p=!1,x=D.message}x&&console.warn("WebGL SDF generation not supported:",x),w=!1,K.set(W,p)}return p}var N=Object.freeze({__proto__:null,generate:b,generateIntoCanvas:O,generateIntoFramebuffer:A,isSupported:j});function se(P,W,p,x,G,L){G===void 0&&(G=Math.max(x[2]-x[0],x[3]-x[1])/2),L===void 0&&(L=1);try{return b.apply(N,arguments)}catch(D){return console.info("WebGL SDF generation failed, falling back to JS",D),y.apply(v,arguments)}}function ie(P,W,p,x,G,L,D,I,C,M){G===void 0&&(G=Math.max(x[2]-x[0],x[3]-x[1])/2),L===void 0&&(L=1),I===void 0&&(I=0),C===void 0&&(C=0),M===void 0&&(M=0);try{return O.apply(N,arguments)}catch(z){return console.info("WebGL SDF generation failed, falling back to JS",z),m.apply(v,arguments)}}return t.forEachPathCommand=r,t.generate=se,t.generateIntoCanvas=ie,t.javascript=v,t.pathToLineSegments=e,t.webgl=N,t.webglUtils=d,Object.defineProperty(t,"__esModule",{value:!0}),t}({});return l}function da(){var l=function(t){var h={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"},u={},r={};u.L=1,r[1]="L",Object.keys(h).forEach(function(R,re){u[R]=1<<re+1,r[u[R]]=R}),Object.freeze(u);var e=u.LRI|u.RLI|u.FSI,o=u.L|u.R|u.AL,a=u.B|u.S|u.WS|u.ON|u.FSI|u.LRI|u.RLI|u.PDI,n=u.BN|u.RLE|u.LRE|u.RLO|u.LRO|u.PDF,i=u.S|u.WS|u.B|e|u.PDI|n,s=null;function f(){if(!s){s=new Map;var R=function(H){if(h.hasOwnProperty(H)){var B=0;h[H].split(",").forEach(function(ae){var Q=ae.split("+"),te=Q[0],J=Q[1];te=parseInt(te,36),J=J?parseInt(J,36):0,s.set(B+=te,u[H]);for(var me=0;me<J;me++)s.set(++B,u[H])})}};for(var re in h)R(re)}}function c(R){return f(),s.get(R.codePointAt(0))||u.L}function d(R){return r[c(R)]}var y={pairs:"14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",canonical:"6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye"};function m(R,re){var H=36,B=0,ae=new Map,Q=re&&new Map,te;return R.split(",").forEach(function J(me){if(me.indexOf("+")!==-1)for(var pe=+me;pe--;)J(te);else{te=me;var ee=me.split(">"),ue=ee[0],ge=ee[1];ue=String.fromCodePoint(B+=parseInt(ue,H)),ge=String.fromCodePoint(B+=parseInt(ge,H)),ae.set(ue,ge),re&&Q.set(ge,ue)}}),{map:ae,reverseMap:Q}}var g,S,v;function _(){if(!g){var R=m(y.pairs,!0),re=R.map,H=R.reverseMap;g=re,S=H,v=m(y.canonical,!1).map}}function F(R){return _(),g.get(R)||null}function U(R){return _(),S.get(R)||null}function T(R){return _(),v.get(R)||null}var k=u.L,w=u.R,Y=u.EN,K=u.ES,ne=u.ET,b=u.AN,O=u.CS,A=u.B,j=u.S,N=u.ON,se=u.BN,ie=u.NSM,P=u.AL,W=u.LRO,p=u.RLO,x=u.LRE,G=u.RLE,L=u.PDF,D=u.LRI,I=u.RLI,C=u.FSI,M=u.PDI;function z(R,re){for(var H=125,B=new Uint32Array(R.length),ae=0;ae<R.length;ae++)B[ae]=c(R[ae]);var Q=new Map;function te(Me,Xe){var Le=B[Me];B[Me]=Xe,Q.set(Le,Q.get(Le)-1),Le&a&&Q.set(a,Q.get(a)-1),Q.set(Xe,(Q.get(Xe)||0)+1),Xe&a&&Q.set(a,(Q.get(a)||0)+1)}for(var J=new Uint8Array(R.length),me=new Map,pe=[],ee=null,ue=0;ue<R.length;ue++)ee||pe.push(ee={start:ue,end:R.length-1,level:re==="rtl"?1:re==="ltr"?0:jt(ue,!1)}),B[ue]&A&&(ee.end=ue,ee=null);for(var ge=G|x|p|W|e|M|L|A,ke=function(Me){return Me+(Me&1?1:2)},le=function(Me){return Me+(Me&1?2:1)},_e=0;_e<pe.length;_e++){ee=pe[_e];var ve=[{_level:ee.level,_override:0,_isolate:0}],oe=void 0,ye=0,Ue=0,Fe=0;Q.clear();for(var de=ee.start;de<=ee.end;de++){var Se=B[de];if(oe=ve[ve.length-1],Q.set(Se,(Q.get(Se)||0)+1),Se&a&&Q.set(a,(Q.get(a)||0)+1),Se&ge)if(Se&(G|x)){J[de]=oe._level;var Pe=(Se===G?le:ke)(oe._level);Pe<=H&&!ye&&!Ue?ve.push({_level:Pe,_override:0,_isolate:0}):ye||Ue++}else if(Se&(p|W)){J[de]=oe._level;var Ye=(Se===p?le:ke)(oe._level);Ye<=H&&!ye&&!Ue?ve.push({_level:Ye,_override:Se&p?w:k,_isolate:0}):ye||Ue++}else if(Se&e){Se&C&&(Se=jt(de+1,!0)===1?I:D),J[de]=oe._level,oe._override&&te(de,oe._override);var Ze=(Se===I?le:ke)(oe._level);Ze<=H&&ye===0&&Ue===0?(Fe++,ve.push({_level:Ze,_override:0,_isolate:1,_isolInitIndex:de})):ye++}else if(Se&M){if(ye>0)ye--;else if(Fe>0){for(Ue=0;!ve[ve.length-1]._isolate;)ve.pop();var He=ve[ve.length-1]._isolInitIndex;He!=null&&(me.set(He,de),me.set(de,He)),ve.pop(),Fe--}oe=ve[ve.length-1],J[de]=oe._level,oe._override&&te(de,oe._override)}else Se&L?(ye===0&&(Ue>0?Ue--:!oe._isolate&&ve.length>1&&(ve.pop(),oe=ve[ve.length-1])),J[de]=oe._level):Se&A&&(J[de]=ee.level);else J[de]=oe._level,oe._override&&Se!==se&&te(de,oe._override)}for(var We=[],Ge=null,we=ee.start;we<=ee.end;we++){var lr=B[we];if(!(lr&n)){var xe=J[we],Te=lr&e,ze=lr===M;Ge&&xe===Ge._level?(Ge._end=we,Ge._endsWithIsolInit=Te):We.push(Ge={_start:we,_end:we,_level:xe,_startsWithPDI:ze,_endsWithIsolInit:Te})}}for(var Re=[],be=0;be<We.length;be++){var De=We[be];if(!De._startsWithPDI||De._startsWithPDI&&!me.has(De._start)){for(var Ne=[Ge=De],Ee=void 0;Ge&&Ge._endsWithIsolInit&&(Ee=me.get(Ge._end))!=null;)for(var Ce=be+1;Ce<We.length;Ce++)if(We[Ce]._start===Ee){Ne.push(Ge=We[Ce]);break}for(var Be=[],Je=0;Je<Ne.length;Je++)for(var Ve=Ne[Je],qe=Ve._start;qe<=Ve._end;qe++)Be.push(qe);for(var Tn=J[Be[0]],Ft=ee.level,kr=Be[0]-1;kr>=0;kr--)if(!(B[kr]&n)){Ft=J[kr];break}var Qr=Be[Be.length-1],xn=J[Qr],Ct=ee.level;if(!(B[Qr]&e)){for(var Fr=Qr+1;Fr<=ee.end;Fr++)if(!(B[Fr]&n)){Ct=J[Fr];break}}Re.push({_seqIndices:Be,_sosType:Math.max(Ft,Tn)%2?w:k,_eosType:Math.max(Ct,xn)%2?w:k})}}for(var Zr=0;Zr<Re.length;Zr++){var qr=Re[Zr],Z=qr._seqIndices,ur=qr._sosType,kn=qr._eosType;if(Q.get(ie))for(var Cr=0;Cr<Z.length;Cr++){var Dt=Z[Cr];if(B[Dt]&ie){for(var $r=ur,Dr=Cr-1;Dr>=0;Dr--)if(!(B[Z[Dr]]&n)){$r=B[Z[Dr]];break}te(Dt,$r&(e|M)?N:$r)}}if(Q.get(Y))for(var Ar=0;Ar<Z.length;Ar++){var At=Z[Ar];if(B[At]&Y)for(var Er=Ar-1;Er>=-1;Er--){var Et=Er===-1?ur:B[Z[Er]];if(Et&o){Et===P&&te(At,b);break}}}if(Q.get(P))for(var et=0;et<Z.length;et++){var Mt=Z[et];B[Mt]&P&&te(Mt,w)}if(Q.get(K)||Q.get(O))for(var cr=1;cr<Z.length-1;cr++){var rt=Z[cr];if(B[rt]&(K|O)){for(var rr=0,tt=0,nt=cr-1;nt>=0&&(rr=B[Z[nt]],!!(rr&n));nt--);for(var at=cr+1;at<Z.length&&(tt=B[Z[at]],!!(tt&n));at++);rr===tt&&(B[rt]===K?rr===Y:rr&(Y|b))&&te(rt,rr)}}if(Q.get(Y))for(var dr=0;dr<Z.length;dr++){var Fn=Z[dr];if(B[Fn]&Y){for(var Mr=dr-1;Mr>=0&&B[Z[Mr]]&(ne|n);Mr--)te(Z[Mr],Y);for(var Pr=dr+1;Pr<Z.length&&B[Z[Pr]]&(ne|n);Pr++)te(Z[Pr],Y)}}if(Q.get(ne)||Q.get(K)||Q.get(O))for(var hr=0;hr<Z.length;hr++){var Pt=Z[hr];if(B[Pt]&(ne|K|O)){te(Pt,N);for(var Br=hr-1;Br>=0&&B[Z[Br]]&n;Br--)te(Z[Br],N);for(var Lr=hr+1;Lr<Z.length&&B[Z[Lr]]&n;Lr++)te(Z[Lr],N)}}if(Q.get(Y))for(var ot=0,Bt=ur;ot<Z.length;ot++){var Lt=Z[ot],it=B[Lt];it&Y?Bt===k&&te(Lt,k):it&o&&(Bt=it)}if(Q.get(a)){var vr=w|Y|b,Gt=vr|k,Gr=[];{for(var tr=[],nr=0;nr<Z.length;nr++)if(B[Z[nr]]&a){var pr=R[Z[nr]],Rt=void 0;if(F(pr)!==null)if(tr.length<63)tr.push({char:pr,seqIndex:nr});else break;else if((Rt=U(pr))!==null)for(var gr=tr.length-1;gr>=0;gr--){var st=tr[gr].char;if(st===Rt||st===U(T(pr))||F(T(st))===pr){Gr.push([tr[gr].seqIndex,nr]),tr.length=gr;break}}}Gr.sort(function(Me,Xe){return Me[0]-Xe[0]})}for(var ft=0;ft<Gr.length;ft++){for(var Ot=Gr[ft],mr=Ot[0],Rr=Ot[1],It=!1,je=0,lt=mr+1;lt<Rr;lt++){var ut=Z[lt];if(B[ut]&Gt){It=!0;var Wt=B[ut]&vr?w:k;if(Wt===ar(ut)){je=Wt;break}}}if(It&&!je){je=ur;for(var ct=mr-1;ct>=0;ct--){var Or=Z[ct];if(B[Or]&Gt){var Nt=B[Or]&vr?w:k;Nt!==ar(Or)?je=Nt:je=ar(Or);break}}}if(je){if(B[Z[mr]]=B[Z[Rr]]=je,je!==ar(Z[mr])){for(var yr=mr+1;yr<Z.length;yr++)if(!(B[Z[yr]]&n)){c(R[Z[yr]])&ie&&(B[Z[yr]]=je);break}}if(je!==ar(Z[Rr])){for(var br=Rr+1;br<Z.length;br++)if(!(B[Z[br]]&n)){c(R[Z[br]])&ie&&(B[Z[br]]=je);break}}}}for(var Ke=0;Ke<Z.length;Ke++)if(B[Z[Ke]]&a){for(var zt=Ke,dt=Ke,ht=ur,Ur=Ke-1;Ur>=0;Ur--)if(B[Z[Ur]]&n)zt=Ur;else{ht=B[Z[Ur]]&vr?w:k;break}for(var Vt=kn,_r=Ke+1;_r<Z.length;_r++)if(B[Z[_r]]&(a|n))dt=_r;else{Vt=B[Z[_r]]&vr?w:k;break}for(var Ir=zt;Ir<=dt;Ir++)B[Z[Ir]]=ht===Vt?ht:ar(Z[Ir]);Ke=dt}}}for(var Oe=ee.start;Oe<=ee.end;Oe++){var Cn=J[Oe],Wr=B[Oe];if(Cn&1?Wr&(k|Y|b)&&J[Oe]++:Wr&w?J[Oe]++:Wr&(b|Y)&&(J[Oe]+=2),Wr&n&&(J[Oe]=Oe===0?ee.level:J[Oe-1]),Oe===ee.end||c(R[Oe])&(j|A))for(var Nr=Oe;Nr>=0&&c(R[Nr])&i;Nr--)J[Nr]=ee.level}}return{levels:J,paragraphs:pe};function jt(Me,Xe){for(var Le=Me;Le<R.length;Le++){var Qe=B[Le];if(Qe&(w|P))return 1;if(Qe&(A|k)||Xe&&Qe===M)return 0;if(Qe&e){var Xt=Dn(Le);Le=Xt===-1?R.length:Xt}}return 0}function Dn(Me){for(var Xe=1,Le=Me+1;Le<R.length;Le++){var Qe=B[Le];if(Qe&A)break;if(Qe&M){if(--Xe===0)return Le}else Qe&e&&Xe++}return-1}function ar(Me){return J[Me]&1?w:k}}var q="14>1,j>2,t>2,u>2,1a>g,2v3>1,1>1,1ge>1,1wd>1,b>1,1j>1,f>1,ai>3,-2>3,+1,8>1k0,-1jq>1y7,-1y6>1hf,-1he>1h6,-1h5>1ha,-1h8>1qi,-1pu>1,6>3u,-3s>7,6>1,1>1,f>1,1>1,+2,3>1,1>1,+13,4>1,1>1,6>1eo,-1ee>1,3>1mg,-1me>1mk,-1mj>1mi,-1mg>1mi,-1md>1,1>1,+2,1>10k,-103>1,1>1,4>1,5>1,1>1,+10,3>1,1>8,-7>8,+1,-6>7,+1,a>1,1>1,u>1,u6>1,1>1,+5,26>1,1>1,2>1,2>2,8>1,7>1,4>1,1>1,+5,b8>1,1>1,+3,1>3,-2>1,2>1,1>1,+2,c>1,3>1,1>1,+2,h>1,3>1,a>1,1>1,2>1,3>1,1>1,d>1,f>1,3>1,1a>1,1>1,6>1,7>1,13>1,k>1,1>1,+19,4>1,1>1,+2,2>1,1>1,+18,m>1,a>1,1>1,lk>1,1>1,4>1,2>1,f>1,3>1,1>1,+3,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,6>1,4j>1,j>2,t>2,u>2,2>1,+1",V;function E(){if(!V){var R=m(q,!0),re=R.map,H=R.reverseMap;H.forEach(function(B,ae){re.set(ae,B)}),V=re}}function he(R){return E(),V.get(R)||null}function ce(R,re,H,B){var ae=R.length;H=Math.max(0,H==null?0:+H),B=Math.min(ae-1,B==null?ae-1:+B);for(var Q=new Map,te=H;te<=B;te++)if(re[te]&1){var J=he(R[te]);J!==null&&Q.set(te,J)}return Q}function X(R,re,H,B){var ae=R.length;H=Math.max(0,H==null?0:+H),B=Math.min(ae-1,B==null?ae-1:+B);var Q=[];return re.paragraphs.forEach(function(te){var J=Math.max(H,te.start),me=Math.min(B,te.end);if(J<me){for(var pe=re.levels.slice(J,me+1),ee=me;ee>=J&&c(R[ee])&i;ee--)pe[ee]=te.level;for(var ue=te.level,ge=1/0,ke=0;ke<pe.length;ke++){var le=pe[ke];le>ue&&(ue=le),le<ge&&(ge=le|1)}for(var _e=ue;_e>=ge;_e--)for(var ve=0;ve<pe.length;ve++)if(pe[ve]>=_e){for(var oe=ve;ve+1<pe.length&&pe[ve+1]>=_e;)ve++;ve>oe&&Q.push([oe+H,ve+H])}}}),Q}function $(R,re,H,B){var ae=fe(R,re,H,B),Q=[].concat(R);return ae.forEach(function(te,J){Q[J]=(re.levels[te]&1?he(R[te]):null)||R[te]}),Q.join("")}function fe(R,re,H,B){for(var ae=X(R,re,H,B),Q=[],te=0;te<R.length;te++)Q[te]=te;return ae.forEach(function(J){for(var me=J[0],pe=J[1],ee=Q.slice(me,pe+1),ue=ee.length;ue--;)Q[pe-ue]=ee[ue]}),Q}return t.closingToOpeningBracket=U,t.getBidiCharType=c,t.getBidiCharTypeName=d,t.getCanonicalBracket=T,t.getEmbeddingLevels=z,t.getMirroredCharacter=he,t.getMirroredCharactersMap=ce,t.getReorderSegments=X,t.getReorderedIndices=fe,t.getReorderedString=$,t.openingToClosingBracket=F,Object.defineProperty(t,"__esModule",{value:!0}),t}({});return l}const vn=/\bvoid\s+main\s*\(\s*\)\s*{/g;function _t(l){const t=/^[ \t]*#include +<([\w\d./]+)>/gm;function h(u,r){let e=Wn[r];return e?_t(e):u}return l.replace(t,h)}const Ae=[];for(let l=0;l<256;l++)Ae[l]=(l<16?"0":"")+l.toString(16);function ha(){const l=Math.random()*4294967295|0,t=Math.random()*4294967295|0,h=Math.random()*4294967295|0,u=Math.random()*4294967295|0;return(Ae[l&255]+Ae[l>>8&255]+Ae[l>>16&255]+Ae[l>>24&255]+"-"+Ae[t&255]+Ae[t>>8&255]+"-"+Ae[t>>16&15|64]+Ae[t>>24&255]+"-"+Ae[h&63|128]+Ae[h>>8&255]+"-"+Ae[h>>16&255]+Ae[h>>24&255]+Ae[u&255]+Ae[u>>8&255]+Ae[u>>16&255]+Ae[u>>24&255]).toUpperCase()}const $e=Object.assign||function(){let l=arguments[0];for(let t=1,h=arguments.length;t<h;t++){let u=arguments[t];if(u)for(let r in u)u.hasOwnProperty(r)&&(l[r]=u[r])}return l},va=Date.now(),Kt=new WeakMap,Qt=new Map;let pa=1e10;function St(l,t){const h=ba(t);let u=Kt.get(l);if(u||Kt.set(l,u=Object.create(null)),u[h])return new u[h];const r=`_onBeforeCompile${h}`,e=function(i){l.onBeforeCompile.call(this,i);const s=this.customProgramCacheKey()+"|"+i.vertexShader+"|"+i.fragmentShader;let f=Qt[s];if(!f){const c=ga(i,t,h);f=Qt[s]=c}i.vertexShader=f.vertexShader,i.fragmentShader=f.fragmentShader,$e(i.uniforms,this.uniforms),t.timeUniform&&(i.uniforms[t.timeUniform]={get value(){return Date.now()-va}}),this[r]&&this[r](i)},o=function(){return a(t.chained?l:l.clone())},a=function(i){const s=Object.create(i,n);return Object.defineProperty(s,"baseMaterial",{value:l}),Object.defineProperty(s,"id",{value:pa++}),s.uuid=ha(),s.uniforms=$e({},i.uniforms,t.uniforms),s.defines=$e({},i.defines,t.defines),s.defines[`TROIKA_DERIVED_MATERIAL_${h}`]="",s.extensions=$e({},i.extensions,t.extensions),s._listeners=void 0,s},n={constructor:{value:o},isDerivedMaterial:{value:!0},customProgramCacheKey:{writable:!0,configurable:!0,value:function(){return l.customProgramCacheKey()+"|"+h}},onBeforeCompile:{get(){return e},set(i){this[r]=i}},copy:{writable:!0,configurable:!0,value:function(i){return l.copy.call(this,i),!l.isShaderMaterial&&!l.isDerivedMaterial&&($e(this.extensions,i.extensions),$e(this.defines,i.defines),$e(this.uniforms,Gn.clone(i.uniforms))),this}},clone:{writable:!0,configurable:!0,value:function(){const i=new l.constructor;return a(i).copy(this)}},getDepthMaterial:{writable:!0,configurable:!0,value:function(){let i=this._depthMaterial;return i||(i=this._depthMaterial=St(l.isDerivedMaterial?l.getDepthMaterial():new Rn({depthPacking:On}),t),i.defines.IS_DEPTH_MATERIAL="",i.uniforms=this.uniforms),i}},getDistanceMaterial:{writable:!0,configurable:!0,value:function(){let i=this._distanceMaterial;return i||(i=this._distanceMaterial=St(l.isDerivedMaterial?l.getDistanceMaterial():new In,t),i.defines.IS_DISTANCE_MATERIAL="",i.uniforms=this.uniforms),i}},dispose:{writable:!0,configurable:!0,value(){const{_depthMaterial:i,_distanceMaterial:s}=this;i&&i.dispose(),s&&s.dispose(),l.dispose.call(this)}}};return u[h]=o,new o}function ga({vertexShader:l,fragmentShader:t},h,u){let{vertexDefs:r,vertexMainIntro:e,vertexMainOutro:o,vertexTransform:a,fragmentDefs:n,fragmentMainIntro:i,fragmentMainOutro:s,fragmentColorTransform:f,customRewriter:c,timeUniform:d}=h;if(r=r||"",e=e||"",o=o||"",n=n||"",i=i||"",s=s||"",(a||c)&&(l=_t(l)),(f||c)&&(t=t.replace(/^[ \t]*#include <((?:tonemapping|encodings|fog|premultiplied_alpha|dithering)_fragment)>/gm,`
//!BEGIN_POST_CHUNK $1
$&
//!END_POST_CHUNK
`),t=_t(t)),c){let y=c({vertexShader:l,fragmentShader:t});l=y.vertexShader,t=y.fragmentShader}if(f){let y=[];t=t.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,m=>(y.push(m),"")),s=`${f}
${y.join(`
`)}
${s}`}if(d){const y=`
uniform float ${d};
`;r=y+r,n=y+n}return a&&(l=`vec3 troika_position_${u};
vec3 troika_normal_${u};
vec2 troika_uv_${u};
${l}
`,r=`${r}
void troikaVertexTransform${u}(inout vec3 position, inout vec3 normal, inout vec2 uv) {
  ${a}
}
`,e=`
troika_position_${u} = vec3(position);
troika_normal_${u} = vec3(normal);
troika_uv_${u} = vec2(uv);
troikaVertexTransform${u}(troika_position_${u}, troika_normal_${u}, troika_uv_${u});
${e}
`,l=l.replace(/\b(position|normal|uv)\b/g,(y,m,g,S)=>/\battribute\s+vec[23]\s+$/.test(S.substr(0,g))?m:`troika_${m}_${u}`)),l=Zt(l,u,r,e,o),t=Zt(t,u,n,i,s),{vertexShader:l,fragmentShader:t}}function Zt(l,t,h,u,r){return(u||r||h)&&(l=l.replace(vn,`
${h}
void troikaOrigMain${t}() {`),l+=`
void main() {
  ${u}
  troikaOrigMain${t}();
  ${r}
}`),l}function ma(l,t){return l==="uniforms"?void 0:typeof t=="function"?t.toString():t}let ya=0;const qt=new Map;function ba(l){const t=JSON.stringify(l,ma);let h=qt.get(t);return h==null&&qt.set(t,h=++ya),h}function Ua(l,t,h){const{defaultFontURL:u}=h,r=Object.create(null),e=1/0,o=/[\u00AD\u034F\u061C\u115F-\u1160\u17B4-\u17B5\u180B-\u180E\u200B-\u200F\u202A-\u202E\u2060-\u206F\u3164\uFE00-\uFE0F\uFEFF\uFFA0\uFFF0-\uFFF8]/,a="[^\\S\\u00A0]",n=new RegExp(`${a}|[\\-\\u007C\\u00AD\\u2010\\u2012-\\u2014\\u2027\\u2056\\u2E17\\u2E40]`);function i(v,_){function F(){const U=T=>{console.error(`Failure loading font ${v}${v===u?"":"; trying fallback"}`,T),v!==u&&(v=u,F())};try{const T=new XMLHttpRequest;T.open("get",v,!0),T.responseType="arraybuffer",T.onload=function(){if(T.status>=400)U(new Error(T.statusText));else if(T.status>0)try{const k=l(T.response);_(k)}catch(k){U(k)}},T.onerror=U,T.send()}catch(T){U(T)}}F()}function s(v,_){v||(v=u);let F=r[v];F?F.pending?F.pending.push(_):_(F):(r[v]={pending:[_]},i(v,U=>{let T=r[v].pending;r[v]=U,T.forEach(k=>k(U))}))}function f({text:v="",font:_=u,sdfGlyphSize:F=64,fontSize:U=1,letterSpacing:T=0,lineHeight:k="normal",maxWidth:w=e,direction:Y,textAlign:K="left",textIndent:ne=0,whiteSpace:b="normal",overflowWrap:O="normal",anchorX:A=0,anchorY:j=0,includeCaretPositions:N=!1,chunkedBoundsSize:se=8192,colorRanges:ie=null},P,W=!1){const p=m(),x={fontLoad:0,typesetting:0};v.indexOf("\r")>-1&&(console.info("Typesetter: got text with \\r chars; normalizing to \\n"),v=v.replace(/\r\n/g,`
`).replace(/\r/g,`
`)),U=+U,T=+T,w=+w,k=k||"normal",ne=+ne,s(_,G=>{const L=isFinite(w);let D=null,I=null,C=null,M=null,z=null,q=null,V=null,E=0,he=0,ce=b!=="nowrap";const{ascender:X,descender:$,unitsPerEm:fe,lineGap:R,capHeight:re,xHeight:H}=G;x.fontLoad=m()-p;const B=m(),ae=U/fe;k==="normal"&&(k=(X-$+R)/fe),k=k*U;const Q=(k-(X-$)*ae)/2,te=-(X*ae+Q),J=Math.min(k,(X-$)*ae),me=(X+$)/2*ae-J/2;let pe=ne,ee=new g;const ue=[ee];G.forEachGlyph(v,U,T,(le,_e,ve)=>{const oe=v.charAt(ve),ye=le.advanceWidth*ae,Ue=ee.count;let Fe;if("isEmpty"in le||(le.isWhitespace=!!oe&&new RegExp(a).test(oe),le.canBreakAfter=!!oe&&n.test(oe),le.isEmpty=le.xMin===le.xMax||le.yMin===le.yMax||o.test(oe)),!le.isWhitespace&&!le.isEmpty&&he++,ce&&L&&!le.isWhitespace&&_e+ye+pe>w&&Ue){if(ee.glyphAt(Ue-1).glyphObj.canBreakAfter)Fe=new g,pe=-_e;else for(let Se=Ue;Se--;)if(Se===0&&O==="break-word"){Fe=new g,pe=-_e;break}else if(ee.glyphAt(Se).glyphObj.canBreakAfter){Fe=ee.splitAt(Se+1);const Pe=Fe.glyphAt(0).x;pe-=Pe;for(let Ye=Fe.count;Ye--;)Fe.glyphAt(Ye).x-=Pe;break}Fe&&(ee.isSoftWrapped=!0,ee=Fe,ue.push(ee),E=w)}let de=ee.glyphAt(ee.count);de.glyphObj=le,de.x=_e+pe,de.width=ye,de.charIndex=ve,oe===`
`&&(ee=new g,ue.push(ee),pe=-(_e+ye+T*U)+ne)}),ue.forEach(le=>{for(let _e=le.count;_e--;){let{glyphObj:ve,x:oe,width:ye}=le.glyphAt(_e);if(!ve.isWhitespace){le.width=oe+ye,le.width>E&&(E=le.width);return}}});let ge=0,ke=0;if(A&&(typeof A=="number"?ge=-A:typeof A=="string"&&(ge=-E*(A==="left"?0:A==="center"?.5:A==="right"?1:d(A)))),j){if(typeof j=="number")ke=-j;else if(typeof j=="string"){let le=ue.length*k;ke=j==="top"?0:j==="top-baseline"?-te:j==="top-cap"?-te-re*ae:j==="top-ex"?-te-H*ae:j==="middle"?le/2:j==="bottom"?le:j==="bottom-baseline"?le-Q+$*ae:d(j)*le}}if(!W){const le=t.getEmbeddingLevels(v,Y);D=new Uint16Array(he),I=new Float32Array(he*2),C={},q=[e,e,-e,-e],V=[];let _e=te;N&&(z=new Float32Array(v.length*3)),ie&&(M=new Uint8Array(he*3));let ve=0,oe=-1,ye=-1,Ue,Fe;if(ue.forEach((de,Se)=>{let{count:Pe,width:Ye}=de;if(Pe>0){let Ze=0;for(let xe=Pe;xe--&&de.glyphAt(xe).glyphObj.isWhitespace;)Ze++;let He=0,We=0;if(K==="center")He=(E-Ye)/2;else if(K==="right")He=E-Ye;else if(K==="justify"&&de.isSoftWrapped){let xe=0;for(let Te=Pe-Ze;Te--;)de.glyphAt(Te).glyphObj.isWhitespace&&xe++;We=(E-Ye)/xe}if(We||He){let xe=0;for(let Te=0;Te<Pe;Te++){let ze=de.glyphAt(Te);const Re=ze.glyphObj;ze.x+=He+xe,We!==0&&Re.isWhitespace&&Te<Pe-Ze&&(xe+=We,ze.width+=We)}}const Ge=t.getReorderSegments(v,le,de.glyphAt(0).charIndex,de.glyphAt(de.count-1).charIndex);for(let xe=0;xe<Ge.length;xe++){const[Te,ze]=Ge[xe];let Re=1/0,be=-1/0;for(let De=0;De<Pe;De++)if(de.glyphAt(De).charIndex>=Te){let Ne=De,Ee=De;for(;Ee<Pe;Ee++){let Ce=de.glyphAt(Ee);if(Ce.charIndex>ze)break;Ee<Pe-Ze&&(Re=Math.min(Re,Ce.x),be=Math.max(be,Ce.x+Ce.width))}for(let Ce=Ne;Ce<Ee;Ce++){const Be=de.glyphAt(Ce);Be.x=be-(Be.x+Be.width-Re)}break}}let we;const lr=xe=>we=xe;for(let xe=0;xe<Pe;xe++){let Te=de.glyphAt(xe);we=Te.glyphObj;const ze=we.index,Re=le.levels[Te.charIndex]&1;if(Re){const be=t.getMirroredCharacter(v[Te.charIndex]);be&&G.forEachGlyph(be,0,0,lr)}if(N){const{charIndex:be}=Te,De=Te.x+ge,Ne=Te.x+Te.width+ge;z[be*3]=Re?Ne:De,z[be*3+1]=Re?De:Ne,z[be*3+2]=_e+me+ke;const Ee=be-oe;Ee>1&&y(z,oe,Ee),oe=be}if(ie){const{charIndex:be}=Te;for(;be>ye;)ye++,ie.hasOwnProperty(ye)&&(Fe=ie[ye])}if(!we.isWhitespace&&!we.isEmpty){const be=ve++;C[ze]||(C[ze]={path:we.path,pathBounds:[we.xMin,we.yMin,we.xMax,we.yMax]});const De=Te.x+ge,Ne=_e+ke;I[be*2]=De,I[be*2+1]=Ne;const Ee=De+we.xMin*ae,Ce=Ne+we.yMin*ae,Be=De+we.xMax*ae,Je=Ne+we.yMax*ae;Ee<q[0]&&(q[0]=Ee),Ce<q[1]&&(q[1]=Ce),Be>q[2]&&(q[2]=Be),Je>q[3]&&(q[3]=Je),be%se===0&&(Ue={start:be,end:be,rect:[e,e,-e,-e]},V.push(Ue)),Ue.end++;const Ve=Ue.rect;if(Ee<Ve[0]&&(Ve[0]=Ee),Ce<Ve[1]&&(Ve[1]=Ce),Be>Ve[2]&&(Ve[2]=Be),Je>Ve[3]&&(Ve[3]=Je),D[be]=ze,ie){const qe=be*3;M[qe]=Fe>>16&255,M[qe+1]=Fe>>8&255,M[qe+2]=Fe&255}}}}_e-=k}),z){const de=v.length-oe;de>1&&y(z,oe,de)}}x.typesetting=m()-B,P({glyphIds:D,glyphPositions:I,glyphData:C,caretPositions:z,caretHeight:J,glyphColors:M,chunkedBounds:V,fontSize:U,unitsPerEm:fe,ascender:X*ae,descender:$*ae,capHeight:re*ae,xHeight:H*ae,lineHeight:k,topBaseline:te,blockBounds:[ge,ke-ue.length*k,ge+E,ke],visibleBounds:q,timings:x})})}function c(v,_){f(v,F=>{const[U,T,k,w]=F.blockBounds;_({width:k-U,height:w-T})},{metricsOnly:!0})}function d(v){let _=v.match(/^([\d.]+)%$/),F=_?parseFloat(_[1]):NaN;return isNaN(F)?0:F/100}function y(v,_,F){const U=v[_*3],T=v[_*3+1],k=v[_*3+2],w=(T-U)/F;for(let Y=0;Y<F;Y++){const K=(_+Y)*3;v[K]=U+w*Y,v[K+1]=U+w*(Y+1),v[K+2]=k}}function m(){return(self.performance||Date).now()}function g(){this.data=[]}const S=["glyphObj","x","width","charIndex"];return g.prototype={width:0,isSoftWrapped:!1,get count(){return Math.ceil(this.data.length/S.length)},glyphAt(v){let _=g.flyweight;return _.data=this.data,_.index=v,_},splitAt(v){let _=new g;return _.data=this.data.splice(v*S.length),_}},g.flyweight=S.reduce((v,_,F,U)=>(Object.defineProperty(v,_,{get(){return this.data[this.index*S.length+F]},set(T){this.data[this.index*S.length+F]=T}}),v),{data:null,index:0}),{typeset:f,measure:c,loadFont:s}}const er=()=>(self.performance||Date).now(),Kr=hn();let $t;function _a(l,t,h,u,r,e,o,a,n,i,s=!0){return s?wa(l,t,h,u,r,e,o,a,n,i).then(null,f=>($t||(console.warn("WebGL SDF generation failed, falling back to JS",f),$t=!0),rn(l,t,h,u,r,e,o,a,n,i))):rn(l,t,h,u,r,e,o,a,n,i)}const Xr=[],Sa=5;let wt=0;function pn(){const l=er();for(;Xr.length&&er()-l<Sa;)Xr.shift()();wt=Xr.length?setTimeout(pn,0):0}const wa=(...l)=>new Promise((t,h)=>{Xr.push(()=>{const u=er();try{Kr.webgl.generateIntoCanvas(...l),t({timing:er()-u})}catch(r){h(r)}}),wt||(wt=setTimeout(pn,0))}),Ta=4,xa=2e3,en={};let ka=0;function rn(l,t,h,u,r,e,o,a,n,i){const s="TroikaTextSDFGenerator_JS_"+ka++%Ta;let f=en[s];return f||(f=en[s]={workerModule:xr({name:s,workerId:s,dependencies:[hn,er],init(c,d){const y=c().javascript.generate;return function(...m){const g=d();return{textureData:y(...m),timing:d()-g}}},getTransferables(c){return[c.textureData.buffer]}}),requests:0,idleTimer:null}),f.requests++,clearTimeout(f.idleTimer),f.workerModule(l,t,h,u,r,e).then(({textureData:c,timing:d})=>{const y=er(),m=new Uint8Array(c.length*4);for(let g=0;g<c.length;g++)m[g*4+i]=c[g];return Kr.webglUtils.renderImageData(o,m,a,n,l,t,1<<3-i),d+=er()-y,--f.requests===0&&(f.idleTimer=setTimeout(()=>{ua(s)},xa)),{timing:d}})}function Fa(l){l._warm||(Kr.webgl.isSupported(l),l._warm=!0)}const Ca=Kr.webglUtils.resizeWebGLCanvasWithoutClearing;/*!
Custom build of Typr.ts (https://github.com/fredli74/Typr.ts) for use in Troika text rendering.
Original MIT license applies: https://github.com/fredli74/Typr.ts/blob/master/LICENSE
*/function Da(){return typeof window>"u"&&(self.window=self),function(l){var t={parse:function(r){var e=t._bin,o=new Uint8Array(r);if(e.readASCII(o,0,4)=="ttcf"){var a=4;e.readUshort(o,a),a+=2,e.readUshort(o,a),a+=2;var n=e.readUint(o,a);a+=4;for(var i=[],s=0;s<n;s++){var f=e.readUint(o,a);a+=4,i.push(t._readFont(o,f))}return i}return[t._readFont(o,0)]},_readFont:function(r,e){var o=t._bin,a=e;o.readFixed(r,e),e+=4;var n=o.readUshort(r,e);e+=2,o.readUshort(r,e),e+=2,o.readUshort(r,e),e+=2,o.readUshort(r,e),e+=2;for(var i=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GPOS","GSUB","SVG "],s={_data:r,_offset:a},f={},c=0;c<n;c++){var d=o.readASCII(r,e,4);e+=4,o.readUint(r,e),e+=4;var y=o.readUint(r,e);e+=4;var m=o.readUint(r,e);e+=4,f[d]={offset:y,length:m}}for(c=0;c<i.length;c++){var g=i[c];f[g]&&(s[g.trim()]=t[g.trim()].parse(r,f[g].offset,f[g].length,s))}return s},_tabOffset:function(r,e,o){for(var a=t._bin,n=a.readUshort(r,o+4),i=o+12,s=0;s<n;s++){var f=a.readASCII(r,i,4);i+=4,a.readUint(r,i),i+=4;var c=a.readUint(r,i);if(i+=4,a.readUint(r,i),i+=4,f==e)return c}return 0}};t._bin={readFixed:function(r,e){return(r[e]<<8|r[e+1])+(r[e+2]<<8|r[e+3])/65540},readF2dot14:function(r,e){return t._bin.readShort(r,e)/16384},readInt:function(r,e){return t._bin._view(r).getInt32(e)},readInt8:function(r,e){return t._bin._view(r).getInt8(e)},readShort:function(r,e){return t._bin._view(r).getInt16(e)},readUshort:function(r,e){return t._bin._view(r).getUint16(e)},readUshorts:function(r,e,o){for(var a=[],n=0;n<o;n++)a.push(t._bin.readUshort(r,e+2*n));return a},readUint:function(r,e){return t._bin._view(r).getUint32(e)},readUint64:function(r,e){return 4294967296*t._bin.readUint(r,e)+t._bin.readUint(r,e+4)},readASCII:function(r,e,o){for(var a="",n=0;n<o;n++)a+=String.fromCharCode(r[e+n]);return a},readUnicode:function(r,e,o){for(var a="",n=0;n<o;n++){var i=r[e++]<<8|r[e++];a+=String.fromCharCode(i)}return a},_tdec:typeof window<"u"&&window.TextDecoder?new window.TextDecoder:null,readUTF8:function(r,e,o){var a=t._bin._tdec;return a&&e==0&&o==r.length?a.decode(r):t._bin.readASCII(r,e,o)},readBytes:function(r,e,o){for(var a=[],n=0;n<o;n++)a.push(r[e+n]);return a},readASCIIArray:function(r,e,o){for(var a=[],n=0;n<o;n++)a.push(String.fromCharCode(r[e+n]));return a},_view:function(r){return r._dataView||(r._dataView=r.buffer?new DataView(r.buffer,r.byteOffset,r.byteLength):new DataView(new Uint8Array(r).buffer))}},t._lctf={},t._lctf.parse=function(r,e,o,a,n){var i=t._bin,s={},f=e;i.readFixed(r,e),e+=4;var c=i.readUshort(r,e);e+=2;var d=i.readUshort(r,e);e+=2;var y=i.readUshort(r,e);return e+=2,s.scriptList=t._lctf.readScriptList(r,f+c),s.featureList=t._lctf.readFeatureList(r,f+d),s.lookupList=t._lctf.readLookupList(r,f+y,n),s},t._lctf.readLookupList=function(r,e,o){var a=t._bin,n=e,i=[],s=a.readUshort(r,e);e+=2;for(var f=0;f<s;f++){var c=a.readUshort(r,e);e+=2;var d=t._lctf.readLookupTable(r,n+c,o);i.push(d)}return i},t._lctf.readLookupTable=function(r,e,o){var a=t._bin,n=e,i={tabs:[]};i.ltype=a.readUshort(r,e),e+=2,i.flag=a.readUshort(r,e),e+=2;var s=a.readUshort(r,e);e+=2;for(var f=i.ltype,c=0;c<s;c++){var d=a.readUshort(r,e);e+=2;var y=o(r,f,n+d,i);i.tabs.push(y)}return i},t._lctf.numOfOnes=function(r){for(var e=0,o=0;o<32;o++)r>>>o&1&&e++;return e},t._lctf.readClassDef=function(r,e){var o=t._bin,a=[],n=o.readUshort(r,e);if(e+=2,n==1){var i=o.readUshort(r,e);e+=2;var s=o.readUshort(r,e);e+=2;for(var f=0;f<s;f++)a.push(i+f),a.push(i+f),a.push(o.readUshort(r,e)),e+=2}if(n==2){var c=o.readUshort(r,e);for(e+=2,f=0;f<c;f++)a.push(o.readUshort(r,e)),e+=2,a.push(o.readUshort(r,e)),e+=2,a.push(o.readUshort(r,e)),e+=2}return a},t._lctf.getInterval=function(r,e){for(var o=0;o<r.length;o+=3){var a=r[o],n=r[o+1];if(r[o+2],a<=e&&e<=n)return o}return-1},t._lctf.readCoverage=function(r,e){var o=t._bin,a={};a.fmt=o.readUshort(r,e),e+=2;var n=o.readUshort(r,e);return e+=2,a.fmt==1&&(a.tab=o.readUshorts(r,e,n)),a.fmt==2&&(a.tab=o.readUshorts(r,e,3*n)),a},t._lctf.coverageIndex=function(r,e){var o=r.tab;if(r.fmt==1)return o.indexOf(e);if(r.fmt==2){var a=t._lctf.getInterval(o,e);if(a!=-1)return o[a+2]+(e-o[a])}return-1},t._lctf.readFeatureList=function(r,e){var o=t._bin,a=e,n=[],i=o.readUshort(r,e);e+=2;for(var s=0;s<i;s++){var f=o.readASCII(r,e,4);e+=4;var c=o.readUshort(r,e);e+=2;var d=t._lctf.readFeatureTable(r,a+c);d.tag=f.trim(),n.push(d)}return n},t._lctf.readFeatureTable=function(r,e){var o=t._bin,a=e,n={},i=o.readUshort(r,e);e+=2,i>0&&(n.featureParams=a+i);var s=o.readUshort(r,e);e+=2,n.tab=[];for(var f=0;f<s;f++)n.tab.push(o.readUshort(r,e+2*f));return n},t._lctf.readScriptList=function(r,e){var o=t._bin,a=e,n={},i=o.readUshort(r,e);e+=2;for(var s=0;s<i;s++){var f=o.readASCII(r,e,4);e+=4;var c=o.readUshort(r,e);e+=2,n[f.trim()]=t._lctf.readScriptTable(r,a+c)}return n},t._lctf.readScriptTable=function(r,e){var o=t._bin,a=e,n={},i=o.readUshort(r,e);e+=2,n.default=t._lctf.readLangSysTable(r,a+i);var s=o.readUshort(r,e);e+=2;for(var f=0;f<s;f++){var c=o.readASCII(r,e,4);e+=4;var d=o.readUshort(r,e);e+=2,n[c.trim()]=t._lctf.readLangSysTable(r,a+d)}return n},t._lctf.readLangSysTable=function(r,e){var o=t._bin,a={};o.readUshort(r,e),e+=2,a.reqFeature=o.readUshort(r,e),e+=2;var n=o.readUshort(r,e);return e+=2,a.features=o.readUshorts(r,e,n),a},t.CFF={},t.CFF.parse=function(r,e,o){var a=t._bin;(r=new Uint8Array(r.buffer,e,o))[e=0],r[++e],r[++e],r[++e],e++;var n=[];e=t.CFF.readIndex(r,e,n);for(var i=[],s=0;s<n.length-1;s++)i.push(a.readASCII(r,e+n[s],n[s+1]-n[s]));e+=n[n.length-1];var f=[];e=t.CFF.readIndex(r,e,f);var c=[];for(s=0;s<f.length-1;s++)c.push(t.CFF.readDict(r,e+f[s],e+f[s+1]));e+=f[f.length-1];var d=c[0],y=[];e=t.CFF.readIndex(r,e,y);var m=[];for(s=0;s<y.length-1;s++)m.push(a.readASCII(r,e+y[s],y[s+1]-y[s]));if(e+=y[y.length-1],t.CFF.readSubrs(r,e,d),d.CharStrings){e=d.CharStrings,y=[],e=t.CFF.readIndex(r,e,y);var g=[];for(s=0;s<y.length-1;s++)g.push(a.readBytes(r,e+y[s],y[s+1]-y[s]));d.CharStrings=g}if(d.ROS){e=d.FDArray;var S=[];for(e=t.CFF.readIndex(r,e,S),d.FDArray=[],s=0;s<S.length-1;s++){var v=t.CFF.readDict(r,e+S[s],e+S[s+1]);t.CFF._readFDict(r,v,m),d.FDArray.push(v)}e+=S[S.length-1],e=d.FDSelect,d.FDSelect=[];var _=r[e];if(e++,_!=3)throw _;var F=a.readUshort(r,e);for(e+=2,s=0;s<F+1;s++)d.FDSelect.push(a.readUshort(r,e),r[e+2]),e+=3}return d.Encoding&&(d.Encoding=t.CFF.readEncoding(r,d.Encoding,d.CharStrings.length)),d.charset&&(d.charset=t.CFF.readCharset(r,d.charset,d.CharStrings.length)),t.CFF._readFDict(r,d,m),d},t.CFF._readFDict=function(r,e,o){var a;for(var n in e.Private&&(a=e.Private[1],e.Private=t.CFF.readDict(r,a,a+e.Private[0]),e.Private.Subrs&&t.CFF.readSubrs(r,a+e.Private.Subrs,e.Private)),e)["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(n)!=-1&&(e[n]=o[e[n]-426+35])},t.CFF.readSubrs=function(r,e,o){var a=t._bin,n=[];e=t.CFF.readIndex(r,e,n);var i,s=n.length;i=s<1240?107:s<33900?1131:32768,o.Bias=i,o.Subrs=[];for(var f=0;f<n.length-1;f++)o.Subrs.push(a.readBytes(r,e+n[f],n[f+1]-n[f]))},t.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],t.CFF.glyphByUnicode=function(r,e){for(var o=0;o<r.charset.length;o++)if(r.charset[o]==e)return o;return-1},t.CFF.glyphBySE=function(r,e){return e<0||e>255?-1:t.CFF.glyphByUnicode(r,t.CFF.tableSE[e])},t.CFF.readEncoding=function(r,e,o){t._bin;var a=[".notdef"],n=r[e];if(e++,n!=0)throw"error: unknown encoding format: "+n;var i=r[e];e++;for(var s=0;s<i;s++)a.push(r[e+s]);return a},t.CFF.readCharset=function(r,e,o){var a=t._bin,n=[".notdef"],i=r[e];if(e++,i==0)for(var s=0;s<o;s++){var f=a.readUshort(r,e);e+=2,n.push(f)}else{if(i!=1&&i!=2)throw"error: format: "+i;for(;n.length<o;){f=a.readUshort(r,e),e+=2;var c=0;for(i==1?(c=r[e],e++):(c=a.readUshort(r,e),e+=2),s=0;s<=c;s++)n.push(f),f++}}return n},t.CFF.readIndex=function(r,e,o){var a=t._bin,n=a.readUshort(r,e)+1,i=r[e+=2];if(e++,i==1)for(var s=0;s<n;s++)o.push(r[e+s]);else if(i==2)for(s=0;s<n;s++)o.push(a.readUshort(r,e+2*s));else if(i==3)for(s=0;s<n;s++)o.push(16777215&a.readUint(r,e+3*s-1));else if(n!=1)throw"unsupported offset size: "+i+", count: "+n;return(e+=n*i)-1},t.CFF.getCharString=function(r,e,o){var a=t._bin,n=r[e],i=r[e+1];r[e+2],r[e+3],r[e+4];var s=1,f=null,c=null;n<=20&&(f=n,s=1),n==12&&(f=100*n+i,s=2),21<=n&&n<=27&&(f=n,s=1),n==28&&(c=a.readShort(r,e+1),s=3),29<=n&&n<=31&&(f=n,s=1),32<=n&&n<=246&&(c=n-139,s=1),247<=n&&n<=250&&(c=256*(n-247)+i+108,s=2),251<=n&&n<=254&&(c=256*-(n-251)-i-108,s=2),n==255&&(c=a.readInt(r,e+1)/65535,s=5),o.val=c??"o"+f,o.size=s},t.CFF.readCharString=function(r,e,o){for(var a=e+o,n=t._bin,i=[];e<a;){var s=r[e],f=r[e+1];r[e+2],r[e+3],r[e+4];var c=1,d=null,y=null;s<=20&&(d=s,c=1),s==12&&(d=100*s+f,c=2),s!=19&&s!=20||(d=s,c=2),21<=s&&s<=27&&(d=s,c=1),s==28&&(y=n.readShort(r,e+1),c=3),29<=s&&s<=31&&(d=s,c=1),32<=s&&s<=246&&(y=s-139,c=1),247<=s&&s<=250&&(y=256*(s-247)+f+108,c=2),251<=s&&s<=254&&(y=256*-(s-251)-f-108,c=2),s==255&&(y=n.readInt(r,e+1)/65535,c=5),i.push(y??"o"+d),e+=c}return i},t.CFF.readDict=function(r,e,o){for(var a=t._bin,n={},i=[];e<o;){var s=r[e],f=r[e+1];r[e+2],r[e+3],r[e+4];var c=1,d=null,y=null;if(s==28&&(y=a.readShort(r,e+1),c=3),s==29&&(y=a.readInt(r,e+1),c=5),32<=s&&s<=246&&(y=s-139,c=1),247<=s&&s<=250&&(y=256*(s-247)+f+108,c=2),251<=s&&s<=254&&(y=256*-(s-251)-f-108,c=2),s==255)throw y=a.readInt(r,e+1)/65535,c=5,"unknown number";if(s==30){var m=[];for(c=1;;){var g=r[e+c];c++;var S=g>>4,v=15&g;if(S!=15&&m.push(S),v!=15&&m.push(v),v==15)break}for(var _="",F=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],U=0;U<m.length;U++)_+=F[m[U]];y=parseFloat(_)}s<=21&&(d=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][s],c=1,s==12&&(d=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][f],c=2)),d!=null?(n[d]=i.length==1?i[0]:i,i=[]):i.push(y),e+=c}return n},t.cmap={},t.cmap.parse=function(r,e,o){r=new Uint8Array(r.buffer,e,o),e=0;var a=t._bin,n={};a.readUshort(r,e),e+=2;var i=a.readUshort(r,e);e+=2;var s=[];n.tables=[];for(var f=0;f<i;f++){var c=a.readUshort(r,e);e+=2;var d=a.readUshort(r,e);e+=2;var y=a.readUint(r,e);e+=4;var m="p"+c+"e"+d,g=s.indexOf(y);if(g==-1){var S;g=n.tables.length,s.push(y);var v=a.readUshort(r,y);v==0?S=t.cmap.parse0(r,y):v==4?S=t.cmap.parse4(r,y):v==6?S=t.cmap.parse6(r,y):v==12?S=t.cmap.parse12(r,y):console.debug("unknown format: "+v,c,d,y),n.tables.push(S)}if(n[m]!=null)throw"multiple tables for one platform+encoding";n[m]=g}return n},t.cmap.parse0=function(r,e){var o=t._bin,a={};a.format=o.readUshort(r,e),e+=2;var n=o.readUshort(r,e);e+=2,o.readUshort(r,e),e+=2,a.map=[];for(var i=0;i<n-6;i++)a.map.push(r[e+i]);return a},t.cmap.parse4=function(r,e){var o=t._bin,a=e,n={};n.format=o.readUshort(r,e),e+=2;var i=o.readUshort(r,e);e+=2,o.readUshort(r,e),e+=2;var s=o.readUshort(r,e);e+=2;var f=s/2;n.searchRange=o.readUshort(r,e),e+=2,n.entrySelector=o.readUshort(r,e),e+=2,n.rangeShift=o.readUshort(r,e),e+=2,n.endCount=o.readUshorts(r,e,f),e+=2*f,e+=2,n.startCount=o.readUshorts(r,e,f),e+=2*f,n.idDelta=[];for(var c=0;c<f;c++)n.idDelta.push(o.readShort(r,e)),e+=2;for(n.idRangeOffset=o.readUshorts(r,e,f),e+=2*f,n.glyphIdArray=[];e<a+i;)n.glyphIdArray.push(o.readUshort(r,e)),e+=2;return n},t.cmap.parse6=function(r,e){var o=t._bin,a={};a.format=o.readUshort(r,e),e+=2,o.readUshort(r,e),e+=2,o.readUshort(r,e),e+=2,a.firstCode=o.readUshort(r,e),e+=2;var n=o.readUshort(r,e);e+=2,a.glyphIdArray=[];for(var i=0;i<n;i++)a.glyphIdArray.push(o.readUshort(r,e)),e+=2;return a},t.cmap.parse12=function(r,e){var o=t._bin,a={};a.format=o.readUshort(r,e),e+=2,e+=2,o.readUint(r,e),e+=4,o.readUint(r,e),e+=4;var n=o.readUint(r,e);e+=4,a.groups=[];for(var i=0;i<n;i++){var s=e+12*i,f=o.readUint(r,s+0),c=o.readUint(r,s+4),d=o.readUint(r,s+8);a.groups.push([f,c,d])}return a},t.glyf={},t.glyf.parse=function(r,e,o,a){for(var n=[],i=0;i<a.maxp.numGlyphs;i++)n.push(null);return n},t.glyf._parseGlyf=function(r,e){var o=t._bin,a=r._data,n=t._tabOffset(a,"glyf",r._offset)+r.loca[e];if(r.loca[e]==r.loca[e+1])return null;var i={};if(i.noc=o.readShort(a,n),n+=2,i.xMin=o.readShort(a,n),n+=2,i.yMin=o.readShort(a,n),n+=2,i.xMax=o.readShort(a,n),n+=2,i.yMax=o.readShort(a,n),n+=2,i.xMin>=i.xMax||i.yMin>=i.yMax)return null;if(i.noc>0){i.endPts=[];for(var s=0;s<i.noc;s++)i.endPts.push(o.readUshort(a,n)),n+=2;var f=o.readUshort(a,n);if(n+=2,a.length-n<f)return null;i.instructions=o.readBytes(a,n,f),n+=f;var c=i.endPts[i.noc-1]+1;for(i.flags=[],s=0;s<c;s++){var d=a[n];if(n++,i.flags.push(d),(8&d)!=0){var y=a[n];n++;for(var m=0;m<y;m++)i.flags.push(d),s++}}for(i.xs=[],s=0;s<c;s++){var g=(2&i.flags[s])!=0,S=(16&i.flags[s])!=0;g?(i.xs.push(S?a[n]:-a[n]),n++):S?i.xs.push(0):(i.xs.push(o.readShort(a,n)),n+=2)}for(i.ys=[],s=0;s<c;s++)g=(4&i.flags[s])!=0,S=(32&i.flags[s])!=0,g?(i.ys.push(S?a[n]:-a[n]),n++):S?i.ys.push(0):(i.ys.push(o.readShort(a,n)),n+=2);var v=0,_=0;for(s=0;s<c;s++)v+=i.xs[s],_+=i.ys[s],i.xs[s]=v,i.ys[s]=_}else{var F;i.parts=[];do{F=o.readUshort(a,n),n+=2;var U={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(i.parts.push(U),U.glyphIndex=o.readUshort(a,n),n+=2,1&F){var T=o.readShort(a,n);n+=2;var k=o.readShort(a,n);n+=2}else T=o.readInt8(a,n),n++,k=o.readInt8(a,n),n++;2&F?(U.m.tx=T,U.m.ty=k):(U.p1=T,U.p2=k),8&F?(U.m.a=U.m.d=o.readF2dot14(a,n),n+=2):64&F?(U.m.a=o.readF2dot14(a,n),n+=2,U.m.d=o.readF2dot14(a,n),n+=2):128&F&&(U.m.a=o.readF2dot14(a,n),n+=2,U.m.b=o.readF2dot14(a,n),n+=2,U.m.c=o.readF2dot14(a,n),n+=2,U.m.d=o.readF2dot14(a,n),n+=2)}while(32&F);if(256&F){var w=o.readUshort(a,n);for(n+=2,i.instr=[],s=0;s<w;s++)i.instr.push(a[n]),n++}}return i},t.GPOS={},t.GPOS.parse=function(r,e,o,a){return t._lctf.parse(r,e,o,a,t.GPOS.subt)},t.GPOS.subt=function(r,e,o,a){var n=t._bin,i=o,s={};if(s.fmt=n.readUshort(r,o),o+=2,e==1||e==2||e==3||e==7||e==8&&s.fmt<=2){var f=n.readUshort(r,o);o+=2,s.coverage=t._lctf.readCoverage(r,f+i)}if(e==1&&s.fmt==1){var c=n.readUshort(r,o);o+=2;var d=t._lctf.numOfOnes(c);c!=0&&(s.pos=t.GPOS.readValueRecord(r,o,c))}else if(e==2&&s.fmt>=1&&s.fmt<=2){c=n.readUshort(r,o),o+=2;var y=n.readUshort(r,o);o+=2,d=t._lctf.numOfOnes(c);var m=t._lctf.numOfOnes(y);if(s.fmt==1){s.pairsets=[];var g=n.readUshort(r,o);o+=2;for(var S=0;S<g;S++){var v=i+n.readUshort(r,o);o+=2;var _=n.readUshort(r,v);v+=2;for(var F=[],U=0;U<_;U++){var T=n.readUshort(r,v);v+=2,c!=0&&(b=t.GPOS.readValueRecord(r,v,c),v+=2*d),y!=0&&(O=t.GPOS.readValueRecord(r,v,y),v+=2*m),F.push({gid2:T,val1:b,val2:O})}s.pairsets.push(F)}}if(s.fmt==2){var k=n.readUshort(r,o);o+=2;var w=n.readUshort(r,o);o+=2;var Y=n.readUshort(r,o);o+=2;var K=n.readUshort(r,o);for(o+=2,s.classDef1=t._lctf.readClassDef(r,i+k),s.classDef2=t._lctf.readClassDef(r,i+w),s.matrix=[],S=0;S<Y;S++){var ne=[];for(U=0;U<K;U++){var b=null,O=null;c!=0&&(b=t.GPOS.readValueRecord(r,o,c),o+=2*d),y!=0&&(O=t.GPOS.readValueRecord(r,o,y),o+=2*m),ne.push({val1:b,val2:O})}s.matrix.push(ne)}}}else{if(e==9&&s.fmt==1){var A=n.readUshort(r,o);o+=2;var j=n.readUint(r,o);if(o+=4,a.ltype==9)a.ltype=A;else if(a.ltype!=A)throw"invalid extension substitution";return t.GPOS.subt(r,a.ltype,i+j)}console.debug("unsupported GPOS table LookupType",e,"format",s.fmt)}return s},t.GPOS.readValueRecord=function(r,e,o){var a=t._bin,n=[];return n.push(1&o?a.readShort(r,e):0),e+=1&o?2:0,n.push(2&o?a.readShort(r,e):0),e+=2&o?2:0,n.push(4&o?a.readShort(r,e):0),e+=4&o?2:0,n.push(8&o?a.readShort(r,e):0),e+=8&o?2:0,n},t.GSUB={},t.GSUB.parse=function(r,e,o,a){return t._lctf.parse(r,e,o,a,t.GSUB.subt)},t.GSUB.subt=function(r,e,o,a){var n=t._bin,i=o,s={};if(s.fmt=n.readUshort(r,o),o+=2,e!=1&&e!=4&&e!=5&&e!=6)return null;if(e==1||e==4||e==5&&s.fmt<=2||e==6&&s.fmt<=2){var f=n.readUshort(r,o);o+=2,s.coverage=t._lctf.readCoverage(r,i+f)}if(e==1&&s.fmt>=1&&s.fmt<=2){if(s.fmt==1)s.delta=n.readShort(r,o),o+=2;else if(s.fmt==2){var c=n.readUshort(r,o);o+=2,s.newg=n.readUshorts(r,o,c),o+=2*s.newg.length}}else if(e==4){s.vals=[],c=n.readUshort(r,o),o+=2;for(var d=0;d<c;d++){var y=n.readUshort(r,o);o+=2,s.vals.push(t.GSUB.readLigatureSet(r,i+y))}}else if(e==5&&s.fmt==2){if(s.fmt==2){var m=n.readUshort(r,o);o+=2,s.cDef=t._lctf.readClassDef(r,i+m),s.scset=[];var g=n.readUshort(r,o);for(o+=2,d=0;d<g;d++){var S=n.readUshort(r,o);o+=2,s.scset.push(S==0?null:t.GSUB.readSubClassSet(r,i+S))}}}else if(e==6&&s.fmt==3){if(s.fmt==3){for(d=0;d<3;d++){c=n.readUshort(r,o),o+=2;for(var v=[],_=0;_<c;_++)v.push(t._lctf.readCoverage(r,i+n.readUshort(r,o+2*_)));o+=2*c,d==0&&(s.backCvg=v),d==1&&(s.inptCvg=v),d==2&&(s.ahedCvg=v)}c=n.readUshort(r,o),o+=2,s.lookupRec=t.GSUB.readSubstLookupRecords(r,o,c)}}else{if(e==7&&s.fmt==1){var F=n.readUshort(r,o);o+=2;var U=n.readUint(r,o);if(o+=4,a.ltype==9)a.ltype=F;else if(a.ltype!=F)throw"invalid extension substitution";return t.GSUB.subt(r,a.ltype,i+U)}console.debug("unsupported GSUB table LookupType",e,"format",s.fmt)}return s},t.GSUB.readSubClassSet=function(r,e){var o=t._bin.readUshort,a=e,n=[],i=o(r,e);e+=2;for(var s=0;s<i;s++){var f=o(r,e);e+=2,n.push(t.GSUB.readSubClassRule(r,a+f))}return n},t.GSUB.readSubClassRule=function(r,e){var o=t._bin.readUshort,a={},n=o(r,e),i=o(r,e+=2);e+=2,a.input=[];for(var s=0;s<n-1;s++)a.input.push(o(r,e)),e+=2;return a.substLookupRecords=t.GSUB.readSubstLookupRecords(r,e,i),a},t.GSUB.readSubstLookupRecords=function(r,e,o){for(var a=t._bin.readUshort,n=[],i=0;i<o;i++)n.push(a(r,e),a(r,e+2)),e+=4;return n},t.GSUB.readChainSubClassSet=function(r,e){var o=t._bin,a=e,n=[],i=o.readUshort(r,e);e+=2;for(var s=0;s<i;s++){var f=o.readUshort(r,e);e+=2,n.push(t.GSUB.readChainSubClassRule(r,a+f))}return n},t.GSUB.readChainSubClassRule=function(r,e){for(var o=t._bin,a={},n=["backtrack","input","lookahead"],i=0;i<n.length;i++){var s=o.readUshort(r,e);e+=2,i==1&&s--,a[n[i]]=o.readUshorts(r,e,s),e+=2*a[n[i]].length}return s=o.readUshort(r,e),e+=2,a.subst=o.readUshorts(r,e,2*s),e+=2*a.subst.length,a},t.GSUB.readLigatureSet=function(r,e){var o=t._bin,a=e,n=[],i=o.readUshort(r,e);e+=2;for(var s=0;s<i;s++){var f=o.readUshort(r,e);e+=2,n.push(t.GSUB.readLigature(r,a+f))}return n},t.GSUB.readLigature=function(r,e){var o=t._bin,a={chain:[]};a.nglyph=o.readUshort(r,e),e+=2;var n=o.readUshort(r,e);e+=2;for(var i=0;i<n-1;i++)a.chain.push(o.readUshort(r,e)),e+=2;return a},t.head={},t.head.parse=function(r,e,o){var a=t._bin,n={};return a.readFixed(r,e),e+=4,n.fontRevision=a.readFixed(r,e),e+=4,a.readUint(r,e),e+=4,a.readUint(r,e),e+=4,n.flags=a.readUshort(r,e),e+=2,n.unitsPerEm=a.readUshort(r,e),e+=2,n.created=a.readUint64(r,e),e+=8,n.modified=a.readUint64(r,e),e+=8,n.xMin=a.readShort(r,e),e+=2,n.yMin=a.readShort(r,e),e+=2,n.xMax=a.readShort(r,e),e+=2,n.yMax=a.readShort(r,e),e+=2,n.macStyle=a.readUshort(r,e),e+=2,n.lowestRecPPEM=a.readUshort(r,e),e+=2,n.fontDirectionHint=a.readShort(r,e),e+=2,n.indexToLocFormat=a.readShort(r,e),e+=2,n.glyphDataFormat=a.readShort(r,e),e+=2,n},t.hhea={},t.hhea.parse=function(r,e,o){var a=t._bin,n={};return a.readFixed(r,e),e+=4,n.ascender=a.readShort(r,e),e+=2,n.descender=a.readShort(r,e),e+=2,n.lineGap=a.readShort(r,e),e+=2,n.advanceWidthMax=a.readUshort(r,e),e+=2,n.minLeftSideBearing=a.readShort(r,e),e+=2,n.minRightSideBearing=a.readShort(r,e),e+=2,n.xMaxExtent=a.readShort(r,e),e+=2,n.caretSlopeRise=a.readShort(r,e),e+=2,n.caretSlopeRun=a.readShort(r,e),e+=2,n.caretOffset=a.readShort(r,e),e+=2,e+=8,n.metricDataFormat=a.readShort(r,e),e+=2,n.numberOfHMetrics=a.readUshort(r,e),e+=2,n},t.hmtx={},t.hmtx.parse=function(r,e,o,a){for(var n=t._bin,i={aWidth:[],lsBearing:[]},s=0,f=0,c=0;c<a.maxp.numGlyphs;c++)c<a.hhea.numberOfHMetrics&&(s=n.readUshort(r,e),e+=2,f=n.readShort(r,e),e+=2),i.aWidth.push(s),i.lsBearing.push(f);return i},t.kern={},t.kern.parse=function(r,e,o,a){var n=t._bin,i=n.readUshort(r,e);if(e+=2,i==1)return t.kern.parseV1(r,e-2,o,a);var s=n.readUshort(r,e);e+=2;for(var f={glyph1:[],rval:[]},c=0;c<s;c++){e+=2,o=n.readUshort(r,e),e+=2;var d=n.readUshort(r,e);e+=2;var y=d>>>8;if((y&=15)!=0)throw"unknown kern table format: "+y;e=t.kern.readFormat0(r,e,f)}return f},t.kern.parseV1=function(r,e,o,a){var n=t._bin;n.readFixed(r,e),e+=4;var i=n.readUint(r,e);e+=4;for(var s={glyph1:[],rval:[]},f=0;f<i;f++){n.readUint(r,e),e+=4;var c=n.readUshort(r,e);e+=2,n.readUshort(r,e),e+=2;var d=c>>>8;if((d&=15)!=0)throw"unknown kern table format: "+d;e=t.kern.readFormat0(r,e,s)}return s},t.kern.readFormat0=function(r,e,o){var a=t._bin,n=-1,i=a.readUshort(r,e);e+=2,a.readUshort(r,e),e+=2,a.readUshort(r,e),e+=2,a.readUshort(r,e),e+=2;for(var s=0;s<i;s++){var f=a.readUshort(r,e);e+=2;var c=a.readUshort(r,e);e+=2;var d=a.readShort(r,e);e+=2,f!=n&&(o.glyph1.push(f),o.rval.push({glyph2:[],vals:[]}));var y=o.rval[o.rval.length-1];y.glyph2.push(c),y.vals.push(d),n=f}return e},t.loca={},t.loca.parse=function(r,e,o,a){var n=t._bin,i=[],s=a.head.indexToLocFormat,f=a.maxp.numGlyphs+1;if(s==0)for(var c=0;c<f;c++)i.push(n.readUshort(r,e+(c<<1))<<1);if(s==1)for(c=0;c<f;c++)i.push(n.readUint(r,e+(c<<2)));return i},t.maxp={},t.maxp.parse=function(r,e,o){var a=t._bin,n={},i=a.readUint(r,e);return e+=4,n.numGlyphs=a.readUshort(r,e),e+=2,i==65536&&(n.maxPoints=a.readUshort(r,e),e+=2,n.maxContours=a.readUshort(r,e),e+=2,n.maxCompositePoints=a.readUshort(r,e),e+=2,n.maxCompositeContours=a.readUshort(r,e),e+=2,n.maxZones=a.readUshort(r,e),e+=2,n.maxTwilightPoints=a.readUshort(r,e),e+=2,n.maxStorage=a.readUshort(r,e),e+=2,n.maxFunctionDefs=a.readUshort(r,e),e+=2,n.maxInstructionDefs=a.readUshort(r,e),e+=2,n.maxStackElements=a.readUshort(r,e),e+=2,n.maxSizeOfInstructions=a.readUshort(r,e),e+=2,n.maxComponentElements=a.readUshort(r,e),e+=2,n.maxComponentDepth=a.readUshort(r,e),e+=2),n},t.name={},t.name.parse=function(r,e,o){var a=t._bin,n={};a.readUshort(r,e),e+=2;var i=a.readUshort(r,e);e+=2,a.readUshort(r,e);for(var s,f=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],c=e+=2,d=0;d<i;d++){var y=a.readUshort(r,e);e+=2;var m=a.readUshort(r,e);e+=2;var g=a.readUshort(r,e);e+=2;var S=a.readUshort(r,e);e+=2;var v=a.readUshort(r,e);e+=2;var _=a.readUshort(r,e);e+=2;var F,U=f[S],T=c+12*i+_;if(y==0)F=a.readUnicode(r,T,v/2);else if(y==3&&m==0)F=a.readUnicode(r,T,v/2);else if(m==0)F=a.readASCII(r,T,v);else if(m==1)F=a.readUnicode(r,T,v/2);else if(m==3)F=a.readUnicode(r,T,v/2);else{if(y!=1)throw"unknown encoding "+m+", platformID: "+y;F=a.readASCII(r,T,v),console.debug("reading unknown MAC encoding "+m+" as ASCII")}var k="p"+y+","+g.toString(16);n[k]==null&&(n[k]={}),n[k][U!==void 0?U:S]=F,n[k]._lang=g}for(var w in n)if(n[w].postScriptName!=null&&n[w]._lang==1033)return n[w];for(var w in n)if(n[w].postScriptName!=null&&n[w]._lang==0)return n[w];for(var w in n)if(n[w].postScriptName!=null&&n[w]._lang==3084)return n[w];for(var w in n)if(n[w].postScriptName!=null)return n[w];for(var w in n){s=w;break}return console.debug("returning name table with languageID "+n[s]._lang),n[s]},t["OS/2"]={},t["OS/2"].parse=function(r,e,o){var a=t._bin.readUshort(r,e);e+=2;var n={};if(a==0)t["OS/2"].version0(r,e,n);else if(a==1)t["OS/2"].version1(r,e,n);else if(a==2||a==3||a==4)t["OS/2"].version2(r,e,n);else{if(a!=5)throw"unknown OS/2 table version: "+a;t["OS/2"].version5(r,e,n)}return n},t["OS/2"].version0=function(r,e,o){var a=t._bin;return o.xAvgCharWidth=a.readShort(r,e),e+=2,o.usWeightClass=a.readUshort(r,e),e+=2,o.usWidthClass=a.readUshort(r,e),e+=2,o.fsType=a.readUshort(r,e),e+=2,o.ySubscriptXSize=a.readShort(r,e),e+=2,o.ySubscriptYSize=a.readShort(r,e),e+=2,o.ySubscriptXOffset=a.readShort(r,e),e+=2,o.ySubscriptYOffset=a.readShort(r,e),e+=2,o.ySuperscriptXSize=a.readShort(r,e),e+=2,o.ySuperscriptYSize=a.readShort(r,e),e+=2,o.ySuperscriptXOffset=a.readShort(r,e),e+=2,o.ySuperscriptYOffset=a.readShort(r,e),e+=2,o.yStrikeoutSize=a.readShort(r,e),e+=2,o.yStrikeoutPosition=a.readShort(r,e),e+=2,o.sFamilyClass=a.readShort(r,e),e+=2,o.panose=a.readBytes(r,e,10),e+=10,o.ulUnicodeRange1=a.readUint(r,e),e+=4,o.ulUnicodeRange2=a.readUint(r,e),e+=4,o.ulUnicodeRange3=a.readUint(r,e),e+=4,o.ulUnicodeRange4=a.readUint(r,e),e+=4,o.achVendID=[a.readInt8(r,e),a.readInt8(r,e+1),a.readInt8(r,e+2),a.readInt8(r,e+3)],e+=4,o.fsSelection=a.readUshort(r,e),e+=2,o.usFirstCharIndex=a.readUshort(r,e),e+=2,o.usLastCharIndex=a.readUshort(r,e),e+=2,o.sTypoAscender=a.readShort(r,e),e+=2,o.sTypoDescender=a.readShort(r,e),e+=2,o.sTypoLineGap=a.readShort(r,e),e+=2,o.usWinAscent=a.readUshort(r,e),e+=2,o.usWinDescent=a.readUshort(r,e),e+=2},t["OS/2"].version1=function(r,e,o){var a=t._bin;return e=t["OS/2"].version0(r,e,o),o.ulCodePageRange1=a.readUint(r,e),e+=4,o.ulCodePageRange2=a.readUint(r,e),e+=4},t["OS/2"].version2=function(r,e,o){var a=t._bin;return e=t["OS/2"].version1(r,e,o),o.sxHeight=a.readShort(r,e),e+=2,o.sCapHeight=a.readShort(r,e),e+=2,o.usDefault=a.readUshort(r,e),e+=2,o.usBreak=a.readUshort(r,e),e+=2,o.usMaxContext=a.readUshort(r,e),e+=2},t["OS/2"].version5=function(r,e,o){var a=t._bin;return e=t["OS/2"].version2(r,e,o),o.usLowerOpticalPointSize=a.readUshort(r,e),e+=2,o.usUpperOpticalPointSize=a.readUshort(r,e),e+=2},t.post={},t.post.parse=function(r,e,o){var a=t._bin,n={};return n.version=a.readFixed(r,e),e+=4,n.italicAngle=a.readFixed(r,e),e+=4,n.underlinePosition=a.readShort(r,e),e+=2,n.underlineThickness=a.readShort(r,e),e+=2,n},t==null&&(t={}),t.U==null&&(t.U={}),t.U.codeToGlyph=function(r,e){var o=r.cmap,a=-1;if(o.p0e4!=null?a=o.p0e4:o.p3e1!=null?a=o.p3e1:o.p1e0!=null?a=o.p1e0:o.p0e3!=null&&(a=o.p0e3),a==-1)throw"no familiar platform and encoding!";var n=o.tables[a];if(n.format==0)return e>=n.map.length?0:n.map[e];if(n.format==4){for(var i=-1,s=0;s<n.endCount.length;s++)if(e<=n.endCount[s]){i=s;break}return i==-1||n.startCount[i]>e?0:65535&(n.idRangeOffset[i]!=0?n.glyphIdArray[e-n.startCount[i]+(n.idRangeOffset[i]>>1)-(n.idRangeOffset.length-i)]:e+n.idDelta[i])}if(n.format==12){if(e>n.groups[n.groups.length-1][1])return 0;for(s=0;s<n.groups.length;s++){var f=n.groups[s];if(f[0]<=e&&e<=f[1])return f[2]+(e-f[0])}return 0}throw"unknown cmap table format "+n.format},t.U.glyphToPath=function(r,e){var o={cmds:[],crds:[]};if(r.SVG&&r.SVG.entries[e]){var a=r.SVG.entries[e];return a==null?o:(typeof a=="string"&&(a=t.SVG.toPath(a),r.SVG.entries[e]=a),a)}if(r.CFF){var n={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:r.CFF.Private?r.CFF.Private.defaultWidthX:0,open:!1},i=r.CFF,s=r.CFF.Private;if(i.ROS){for(var f=0;i.FDSelect[f+2]<=e;)f+=2;s=i.FDArray[i.FDSelect[f+1]].Private}t.U._drawCFF(r.CFF.CharStrings[e],n,i,s,o)}else r.glyf&&t.U._drawGlyf(e,r,o);return o},t.U._drawGlyf=function(r,e,o){var a=e.glyf[r];a==null&&(a=e.glyf[r]=t.glyf._parseGlyf(e,r)),a!=null&&(a.noc>-1?t.U._simpleGlyph(a,o):t.U._compoGlyph(a,e,o))},t.U._simpleGlyph=function(r,e){for(var o=0;o<r.noc;o++){for(var a=o==0?0:r.endPts[o-1]+1,n=r.endPts[o],i=a;i<=n;i++){var s=i==a?n:i-1,f=i==n?a:i+1,c=1&r.flags[i],d=1&r.flags[s],y=1&r.flags[f],m=r.xs[i],g=r.ys[i];if(i==a)if(c){if(!d){t.U.P.moveTo(e,m,g);continue}t.U.P.moveTo(e,r.xs[s],r.ys[s])}else d?t.U.P.moveTo(e,r.xs[s],r.ys[s]):t.U.P.moveTo(e,(r.xs[s]+m)/2,(r.ys[s]+g)/2);c?d&&t.U.P.lineTo(e,m,g):y?t.U.P.qcurveTo(e,m,g,r.xs[f],r.ys[f]):t.U.P.qcurveTo(e,m,g,(m+r.xs[f])/2,(g+r.ys[f])/2)}t.U.P.closePath(e)}},t.U._compoGlyph=function(r,e,o){for(var a=0;a<r.parts.length;a++){var n={cmds:[],crds:[]},i=r.parts[a];t.U._drawGlyf(i.glyphIndex,e,n);for(var s=i.m,f=0;f<n.crds.length;f+=2){var c=n.crds[f],d=n.crds[f+1];o.crds.push(c*s.a+d*s.b+s.tx),o.crds.push(c*s.c+d*s.d+s.ty)}for(f=0;f<n.cmds.length;f++)o.cmds.push(n.cmds[f])}},t.U._getGlyphClass=function(r,e){var o=t._lctf.getInterval(e,r);return o==-1?0:e[o+2]},t.U.getPairAdjustment=function(r,e,o){var a=!1;if(r.GPOS)for(var n=r.GPOS,i=n.lookupList,s=n.featureList,f=[],c=0;c<s.length;c++){var d=s[c];if(d.tag=="kern"){a=!0;for(var y=0;y<d.tab.length;y++)if(!f[d.tab[y]]){f[d.tab[y]]=!0;for(var m=i[d.tab[y]],g=0;g<m.tabs.length;g++)if(m.tabs[g]!=null){var S,v=m.tabs[g];if((!v.coverage||(S=t._lctf.coverageIndex(v.coverage,e))!=-1)&&m.ltype!=1){if(m.ltype==2){var _=null;if(v.fmt==1){var F=v.pairsets[S];for(c=0;c<F.length;c++)F[c].gid2==o&&(_=F[c])}else if(v.fmt==2){var U=t.U._getGlyphClass(e,v.classDef1),T=t.U._getGlyphClass(o,v.classDef2);_=v.matrix[U][T]}if(_){var k=0;return _.val1&&_.val1[2]&&(k+=_.val1[2]),_.val2&&_.val2[0]&&(k+=_.val2[0]),k}}}}}}}if(r.kern&&!a){var w=r.kern.glyph1.indexOf(e);if(w!=-1){var Y=r.kern.rval[w].glyph2.indexOf(o);if(Y!=-1)return r.kern.rval[w].vals[Y]}}return 0},t.U._applySubs=function(r,e,o,a){for(var n=r.length-e-1,i=0;i<o.tabs.length;i++)if(o.tabs[i]!=null){var s,f=o.tabs[i];if(!f.coverage||(s=t._lctf.coverageIndex(f.coverage,r[e]))!=-1){if(o.ltype==1)r[e],f.fmt==1?r[e]=r[e]+f.delta:r[e]=f.newg[s];else if(o.ltype==4)for(var c=f.vals[s],d=0;d<c.length;d++){var y=c[d],m=y.chain.length;if(!(m>n)){for(var g=!0,S=0,v=0;v<m;v++){for(;r[e+S+(1+v)]==-1;)S++;y.chain[v]!=r[e+S+(1+v)]&&(g=!1)}if(g){for(r[e]=y.nglyph,v=0;v<m+S;v++)r[e+v+1]=-1;break}}}else if(o.ltype==5&&f.fmt==2)for(var _=t._lctf.getInterval(f.cDef,r[e]),F=f.cDef[_+2],U=f.scset[F],T=0;T<U.length;T++){var k=U[T],w=k.input;if(!(w.length>n)){for(g=!0,v=0;v<w.length;v++){var Y=t._lctf.getInterval(f.cDef,r[e+1+v]);if(_==-1&&f.cDef[Y+2]!=w[v]){g=!1;break}}if(g){var K=k.substLookupRecords;for(d=0;d<K.length;d+=2)K[d],K[d+1]}}}else if(o.ltype==6&&f.fmt==3){if(!t.U._glsCovered(r,f.backCvg,e-f.backCvg.length)||!t.U._glsCovered(r,f.inptCvg,e)||!t.U._glsCovered(r,f.ahedCvg,e+f.inptCvg.length))continue;var ne=f.lookupRec;for(T=0;T<ne.length;T+=2){_=ne[T];var b=a[ne[T+1]];t.U._applySubs(r,e+_,b,a)}}}}},t.U._glsCovered=function(r,e,o){for(var a=0;a<e.length;a++)if(t._lctf.coverageIndex(e[a],r[o+a])==-1)return!1;return!0},t.U.glyphsToPath=function(r,e,o){for(var a={cmds:[],crds:[]},n=0,i=0;i<e.length;i++){var s=e[i];if(s!=-1){for(var f=i<e.length-1&&e[i+1]!=-1?e[i+1]:0,c=t.U.glyphToPath(r,s),d=0;d<c.crds.length;d+=2)a.crds.push(c.crds[d]+n),a.crds.push(c.crds[d+1]);for(o&&a.cmds.push(o),d=0;d<c.cmds.length;d++)a.cmds.push(c.cmds[d]);o&&a.cmds.push("X"),n+=r.hmtx.aWidth[s],i<e.length-1&&(n+=t.U.getPairAdjustment(r,s,f))}}return a},t.U.P={},t.U.P.moveTo=function(r,e,o){r.cmds.push("M"),r.crds.push(e,o)},t.U.P.lineTo=function(r,e,o){r.cmds.push("L"),r.crds.push(e,o)},t.U.P.curveTo=function(r,e,o,a,n,i,s){r.cmds.push("C"),r.crds.push(e,o,a,n,i,s)},t.U.P.qcurveTo=function(r,e,o,a,n){r.cmds.push("Q"),r.crds.push(e,o,a,n)},t.U.P.closePath=function(r){r.cmds.push("Z")},t.U._drawCFF=function(r,e,o,a,n){for(var i=e.stack,s=e.nStems,f=e.haveWidth,c=e.width,d=e.open,y=0,m=e.x,g=e.y,S=0,v=0,_=0,F=0,U=0,T=0,k=0,w=0,Y=0,K=0,ne={val:0,size:0};y<r.length;){t.CFF.getCharString(r,y,ne);var b=ne.val;if(y+=ne.size,b=="o1"||b=="o18")i.length%2!=0&&!f&&(c=i.shift()+a.nominalWidthX),s+=i.length>>1,i.length=0,f=!0;else if(b=="o3"||b=="o23")i.length%2!=0&&!f&&(c=i.shift()+a.nominalWidthX),s+=i.length>>1,i.length=0,f=!0;else if(b=="o4")i.length>1&&!f&&(c=i.shift()+a.nominalWidthX,f=!0),d&&t.U.P.closePath(n),g+=i.pop(),t.U.P.moveTo(n,m,g),d=!0;else if(b=="o5")for(;i.length>0;)m+=i.shift(),g+=i.shift(),t.U.P.lineTo(n,m,g);else if(b=="o6"||b=="o7")for(var O=i.length,A=b=="o6",j=0;j<O;j++){var N=i.shift();A?m+=N:g+=N,A=!A,t.U.P.lineTo(n,m,g)}else if(b=="o8"||b=="o24"){O=i.length;for(var se=0;se+6<=O;)S=m+i.shift(),v=g+i.shift(),_=S+i.shift(),F=v+i.shift(),m=_+i.shift(),g=F+i.shift(),t.U.P.curveTo(n,S,v,_,F,m,g),se+=6;b=="o24"&&(m+=i.shift(),g+=i.shift(),t.U.P.lineTo(n,m,g))}else{if(b=="o11")break;if(b=="o1234"||b=="o1235"||b=="o1236"||b=="o1237")b=="o1234"&&(v=g,_=(S=m+i.shift())+i.shift(),K=F=v+i.shift(),T=F,w=g,m=(k=(U=(Y=_+i.shift())+i.shift())+i.shift())+i.shift(),t.U.P.curveTo(n,S,v,_,F,Y,K),t.U.P.curveTo(n,U,T,k,w,m,g)),b=="o1235"&&(S=m+i.shift(),v=g+i.shift(),_=S+i.shift(),F=v+i.shift(),Y=_+i.shift(),K=F+i.shift(),U=Y+i.shift(),T=K+i.shift(),k=U+i.shift(),w=T+i.shift(),m=k+i.shift(),g=w+i.shift(),i.shift(),t.U.P.curveTo(n,S,v,_,F,Y,K),t.U.P.curveTo(n,U,T,k,w,m,g)),b=="o1236"&&(S=m+i.shift(),v=g+i.shift(),_=S+i.shift(),K=F=v+i.shift(),T=F,k=(U=(Y=_+i.shift())+i.shift())+i.shift(),w=T+i.shift(),m=k+i.shift(),t.U.P.curveTo(n,S,v,_,F,Y,K),t.U.P.curveTo(n,U,T,k,w,m,g)),b=="o1237"&&(S=m+i.shift(),v=g+i.shift(),_=S+i.shift(),F=v+i.shift(),Y=_+i.shift(),K=F+i.shift(),U=Y+i.shift(),T=K+i.shift(),k=U+i.shift(),w=T+i.shift(),Math.abs(k-m)>Math.abs(w-g)?m=k+i.shift():g=w+i.shift(),t.U.P.curveTo(n,S,v,_,F,Y,K),t.U.P.curveTo(n,U,T,k,w,m,g));else if(b=="o14"){if(i.length>0&&!f&&(c=i.shift()+o.nominalWidthX,f=!0),i.length==4){var ie=i.shift(),P=i.shift(),W=i.shift(),p=i.shift(),x=t.CFF.glyphBySE(o,W),G=t.CFF.glyphBySE(o,p);t.U._drawCFF(o.CharStrings[x],e,o,a,n),e.x=ie,e.y=P,t.U._drawCFF(o.CharStrings[G],e,o,a,n)}d&&(t.U.P.closePath(n),d=!1)}else if(b=="o19"||b=="o20")i.length%2!=0&&!f&&(c=i.shift()+a.nominalWidthX),s+=i.length>>1,i.length=0,f=!0,y+=s+7>>3;else if(b=="o21")i.length>2&&!f&&(c=i.shift()+a.nominalWidthX,f=!0),g+=i.pop(),m+=i.pop(),d&&t.U.P.closePath(n),t.U.P.moveTo(n,m,g),d=!0;else if(b=="o22")i.length>1&&!f&&(c=i.shift()+a.nominalWidthX,f=!0),m+=i.pop(),d&&t.U.P.closePath(n),t.U.P.moveTo(n,m,g),d=!0;else if(b=="o25"){for(;i.length>6;)m+=i.shift(),g+=i.shift(),t.U.P.lineTo(n,m,g);S=m+i.shift(),v=g+i.shift(),_=S+i.shift(),F=v+i.shift(),m=_+i.shift(),g=F+i.shift(),t.U.P.curveTo(n,S,v,_,F,m,g)}else if(b=="o26")for(i.length%2&&(m+=i.shift());i.length>0;)S=m,v=g+i.shift(),m=_=S+i.shift(),g=(F=v+i.shift())+i.shift(),t.U.P.curveTo(n,S,v,_,F,m,g);else if(b=="o27")for(i.length%2&&(g+=i.shift());i.length>0;)v=g,_=(S=m+i.shift())+i.shift(),F=v+i.shift(),m=_+i.shift(),g=F,t.U.P.curveTo(n,S,v,_,F,m,g);else if(b=="o10"||b=="o29"){var L=b=="o10"?a:o;if(i.length==0)console.debug("error: empty stack");else{var D=i.pop(),I=L.Subrs[D+L.Bias];e.x=m,e.y=g,e.nStems=s,e.haveWidth=f,e.width=c,e.open=d,t.U._drawCFF(I,e,o,a,n),m=e.x,g=e.y,s=e.nStems,f=e.haveWidth,c=e.width,d=e.open}}else if(b=="o30"||b=="o31"){var C=i.length,M=(se=0,b=="o31");for(se+=C-(O=-3&C);se<O;)M?(v=g,_=(S=m+i.shift())+i.shift(),g=(F=v+i.shift())+i.shift(),O-se==5?(m=_+i.shift(),se++):m=_,M=!1):(S=m,v=g+i.shift(),_=S+i.shift(),F=v+i.shift(),m=_+i.shift(),O-se==5?(g=F+i.shift(),se++):g=F,M=!0),t.U.P.curveTo(n,S,v,_,F,m,g),se+=4}else{if((b+"").charAt(0)=="o")throw console.debug("Unknown operation: "+b,r),b;i.push(b)}}}e.x=m,e.y=g,e.nStems=s,e.haveWidth=f,e.width=c,e.open=d};var h=t,u={Typr:h};return l.Typr=h,l.default=u,Object.defineProperty(l,"__esModule",{value:!0}),l}({}).Typr}/*!
Custom bundle of woff2otf (https://github.com/arty-name/woff2otf) with fflate
(https://github.com/101arrowz/fflate) for use in Troika text rendering. 
Original licenses apply: 
- fflate: https://github.com/101arrowz/fflate/blob/master/LICENSE (MIT)
- woff2otf.js: https://github.com/arty-name/woff2otf/blob/master/woff2otf.js (Apache2)
*/function Aa(){return function(l){var t=Uint8Array,h=Uint16Array,u=Uint32Array,r=new t([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),e=new t([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),o=new t([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),a=function(b,O){for(var A=new h(31),j=0;j<31;++j)A[j]=O+=1<<b[j-1];var N=new u(A[30]);for(j=1;j<30;++j)for(var se=A[j];se<A[j+1];++se)N[se]=se-A[j]<<5|j;return[A,N]},n=a(r,2),i=n[0],s=n[1];i[28]=258,s[258]=28;for(var f=a(e,0)[0],c=new h(32768),d=0;d<32768;++d){var y=(43690&d)>>>1|(21845&d)<<1;y=(61680&(y=(52428&y)>>>2|(13107&y)<<2))>>>4|(3855&y)<<4,c[d]=((65280&y)>>>8|(255&y)<<8)>>>1}var m=function(b,O,A){for(var j=b.length,N=0,se=new h(O);N<j;++N)++se[b[N]-1];var ie,P=new h(O);for(N=0;N<O;++N)P[N]=P[N-1]+se[N-1]<<1;if(A){ie=new h(1<<O);var W=15-O;for(N=0;N<j;++N)if(b[N])for(var p=N<<4|b[N],x=O-b[N],G=P[b[N]-1]++<<x,L=G|(1<<x)-1;G<=L;++G)ie[c[G]>>>W]=p}else for(ie=new h(j),N=0;N<j;++N)b[N]&&(ie[N]=c[P[b[N]-1]++]>>>15-b[N]);return ie},g=new t(288);for(d=0;d<144;++d)g[d]=8;for(d=144;d<256;++d)g[d]=9;for(d=256;d<280;++d)g[d]=7;for(d=280;d<288;++d)g[d]=8;var S=new t(32);for(d=0;d<32;++d)S[d]=5;var v=m(g,9,1),_=m(S,5,1),F=function(b){for(var O=b[0],A=1;A<b.length;++A)b[A]>O&&(O=b[A]);return O},U=function(b,O,A){var j=O/8|0;return(b[j]|b[j+1]<<8)>>(7&O)&A},T=function(b,O){var A=O/8|0;return(b[A]|b[A+1]<<8|b[A+2]<<16)>>(7&O)},k=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],w=function(b,O,A){var j=new Error(O||k[b]);if(j.code=b,Error.captureStackTrace&&Error.captureStackTrace(j,w),!A)throw j;return j},Y=function(b,O,A){var j=b.length;if(!j||A&&!A.l&&j<5)return O||new t(0);var N=!O||A,se=!A||A.i;A||(A={}),O||(O=new t(3*j));var ie,P=function(oe){var ye=O.length;if(oe>ye){var Ue=new t(Math.max(2*ye,oe));Ue.set(O),O=Ue}},W=A.f||0,p=A.p||0,x=A.b||0,G=A.l,L=A.d,D=A.m,I=A.n,C=8*j;do{if(!G){A.f=W=U(b,p,1);var M=U(b,p+1,3);if(p+=3,!M){var z=b[(H=((ie=p)/8|0)+(7&ie&&1)+4)-4]|b[H-3]<<8,q=H+z;if(q>j){se&&w(0);break}N&&P(x+z),O.set(b.subarray(H,q),x),A.b=x+=z,A.p=p=8*q;continue}if(M==1)G=v,L=_,D=9,I=5;else if(M==2){var V=U(b,p,31)+257,E=U(b,p+10,15)+4,he=V+U(b,p+5,31)+1;p+=14;for(var ce=new t(he),X=new t(19),$=0;$<E;++$)X[o[$]]=U(b,p+3*$,7);p+=3*E;var fe=F(X),R=(1<<fe)-1,re=m(X,fe,1);for($=0;$<he;){var H,B=re[U(b,p,R)];if(p+=15&B,(H=B>>>4)<16)ce[$++]=H;else{var ae=0,Q=0;for(H==16?(Q=3+U(b,p,3),p+=2,ae=ce[$-1]):H==17?(Q=3+U(b,p,7),p+=3):H==18&&(Q=11+U(b,p,127),p+=7);Q--;)ce[$++]=ae}}var te=ce.subarray(0,V),J=ce.subarray(V);D=F(te),I=F(J),G=m(te,D,1),L=m(J,I,1)}else w(1);if(p>C){se&&w(0);break}}N&&P(x+131072);for(var me=(1<<D)-1,pe=(1<<I)-1,ee=p;;ee=p){var ue=(ae=G[T(b,p)&me])>>>4;if((p+=15&ae)>C){se&&w(0);break}if(ae||w(2),ue<256)O[x++]=ue;else{if(ue==256){ee=p,G=null;break}var ge=ue-254;if(ue>264){var ke=r[$=ue-257];ge=U(b,p,(1<<ke)-1)+i[$],p+=ke}var le=L[T(b,p)&pe],_e=le>>>4;if(le||w(3),p+=15&le,J=f[_e],_e>3&&(ke=e[_e],J+=T(b,p)&(1<<ke)-1,p+=ke),p>C){se&&w(0);break}N&&P(x+131072);for(var ve=x+ge;x<ve;x+=4)O[x]=O[x-J],O[x+1]=O[x+1-J],O[x+2]=O[x+2-J],O[x+3]=O[x+3-J];x=ve}}A.l=G,A.p=ee,A.b=x,G&&(W=1,A.m=D,A.d=L,A.n=I)}while(!W);return x==O.length?O:function(oe,ye,Ue){(ye==null||ye<0)&&(ye=0),(Ue==null||Ue>oe.length)&&(Ue=oe.length);var Fe=new(oe instanceof h?h:oe instanceof u?u:t)(Ue-ye);return Fe.set(oe.subarray(ye,Ue)),Fe}(O,0,x)},K=new t(0),ne=typeof TextDecoder<"u"&&new TextDecoder;try{ne.decode(K,{stream:!0})}catch{}return l.convert_streams=function(b){var O=new DataView(b),A=0;function j(){var V=O.getUint16(A);return A+=2,V}function N(){var V=O.getUint32(A);return A+=4,V}function se(V){z.setUint16(q,V),q+=2}function ie(V){z.setUint32(q,V),q+=4}for(var P={signature:N(),flavor:N(),length:N(),numTables:j(),reserved:j(),totalSfntSize:N(),majorVersion:j(),minorVersion:j(),metaOffset:N(),metaLength:N(),metaOrigLength:N(),privOffset:N(),privLength:N()},W=0;Math.pow(2,W)<=P.numTables;)W++;W--;for(var p=16*Math.pow(2,W),x=16*P.numTables-p,G=12,L=[],D=0;D<P.numTables;D++)L.push({tag:N(),offset:N(),compLength:N(),origLength:N(),origChecksum:N()}),G+=16;var I,C=new Uint8Array(12+16*L.length+L.reduce(function(V,E){return V+E.origLength+4},0)),M=C.buffer,z=new DataView(M),q=0;return ie(P.flavor),se(P.numTables),se(p),se(W),se(x),L.forEach(function(V){ie(V.tag),ie(V.origChecksum),ie(G),ie(V.origLength),V.outOffset=G,(G+=V.origLength)%4!=0&&(G+=4-G%4)}),L.forEach(function(V){var E,he=b.slice(V.offset,V.offset+V.compLength);if(V.compLength!=V.origLength){var ce=new Uint8Array(V.origLength);E=new Uint8Array(he,2),Y(E,ce)}else ce=new Uint8Array(he);C.set(ce,V.outOffset);var X=0;(G=V.outOffset+V.origLength)%4!=0&&(X=4-G%4),C.set(new Uint8Array(X).buffer,V.outOffset+V.origLength),I=G+X}),M.slice(0,I)},Object.defineProperty(l,"__esModule",{value:!0}),l}({}).convert_streams}function Ea(l,t){const h={M:2,L:2,Q:4,C:6,Z:0},u={C:"18g,ca,368,1kz",D:"17k,6,2,2+4,5+c,2+6,2+1,10+1,9+f,j+11,2+1,a,2,2+1,15+2,3,j+2,6+3,2+8,2,2,2+1,w+a,4+e,3+3,2,3+2,3+5,23+w,2f+4,3,2+9,2,b,2+3,3,1k+9,6+1,3+1,2+2,2+d,30g,p+y,1,1+1g,f+x,2,sd2+1d,jf3+4,f+3,2+4,2+2,b+3,42,2,4+2,2+1,2,3,t+1,9f+w,2,el+2,2+g,d+2,2l,2+1,5,3+1,2+1,2,3,6,16wm+1v",R:"17m+3,2,2,6+3,m,15+2,2+2,h+h,13,3+8,2,2,3+1,2,p+1,x,5+4,5,a,2,2,3,u,c+2,g+1,5,2+1,4+1,5j,6+1,2,b,2+2,f,2+1,1s+2,2,3+1,7,1ez0,2,2+1,4+4,b,4,3,b,42,2+2,4,3,2+1,2,o+3,ae,ep,x,2o+2,3+1,3,5+1,6",L:"x9u,jff,a,fd,jv",T:"4t,gj+33,7o+4,1+1,7c+18,2,2+1,2+1,2,21+a,2,1b+k,h,2u+6,3+5,3+1,2+3,y,2,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,3,7,6+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+d,1,1+1,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,ek,3+1,r+4,1e+4,6+5,2p+c,1+3,1,1+2,1+b,2db+2,3y,2p+v,ff+3,30+1,n9x,1+2,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,5s,6y+2,ea,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+9,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2,2b+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,470+8,at4+4,1o+6,t5,1s+3,2a,f5l+1,2+3,43o+2,a+7,1+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,1,gzau,v+2n,3l+6n"},r=1,e=2,o=4,a=8,n=16,i=32;let s;function f(U){if(!s){const T={R:e,L:r,D:o,C:n,U:i,T:a};s=new Map;for(let k in u){let w=0;u[k].split(",").forEach(Y=>{let[K,ne]=Y.split("+");K=parseInt(K,36),ne=ne?parseInt(ne,36):0,s.set(w+=K,T[k]);for(let b=ne;b--;)s.set(++w,T[k])})}}return s.get(U)||i}const c=1,d=2,y=3,m=4,g=[null,"isol","init","fina","medi"];function S(U){const T=new Uint8Array(U.length);let k=i,w=c,Y=-1;for(let K=0;K<U.length;K++){const ne=U.codePointAt(K);let b=f(ne)|0,O=c;b&a||(k&(r|o|n)?b&(e|o|n)?(O=y,(w===c||w===y)&&T[Y]++):b&(r|i)&&(w===d||w===m)&&T[Y]--:k&(e|i)&&(w===d||w===m)&&T[Y]--,w=T[K]=O,k=b,Y=K,ne>65535&&K++)}return T}function v(U,T){const k=[];for(let Y=0;Y<T.length;Y++){const K=T.codePointAt(Y);K>65535&&Y++,k.push(l.U.codeToGlyph(U,K))}const w=U.GSUB;if(w){const{lookupList:Y,featureList:K}=w;let ne;const b=/^(rlig|liga|mset|isol|init|fina|medi|half|pres|blws)$/,O=[];K.forEach(A=>{if(b.test(A.tag))for(let j=0;j<A.tab.length;j++){if(O[A.tab[j]])continue;O[A.tab[j]]=!0;const N=Y[A.tab[j]],se=/^(isol|init|fina|medi)$/.test(A.tag);se&&!ne&&(ne=S(T));for(let ie=0;ie<k.length;ie++)(!ne||!se||g[ne[ie]]===A.tag)&&l.U._applySubs(k,ie,N,Y)}})}return k}function _(...U){for(let T=0;T<U.length;T++)if(typeof U[T]=="number")return U[T]}function F(U){const T=Object.create(null),k=U["OS/2"],w=U.hhea,Y=U.head.unitsPerEm,K=_(k&&k.sTypoAscender,w&&w.ascender,Y),ne={unitsPerEm:Y,ascender:K,descender:_(k&&k.sTypoDescender,w&&w.descender,0),capHeight:_(k&&k.sCapHeight,K),xHeight:_(k&&k.sxHeight,K),lineGap:_(k&&k.sTypoLineGap,w&&w.lineGap),forEachGlyph(b,O,A,j){let N=0;const se=1/ne.unitsPerEm*O,ie=v(U,b);let P=0,W=-1;return ie.forEach((p,x)=>{if(p!==-1){let G=T[p];if(!G){const{cmds:L,crds:D}=l.U.glyphToPath(U,p);let I="",C=0;for(let E=0,he=L.length;E<he;E++){const ce=h[L[E]];I+=L[E];for(let X=1;X<=ce;X++)I+=(X>1?",":"")+D[C++]}let M,z,q,V;if(D.length){M=z=1/0,q=V=-1/0;for(let E=0,he=D.length;E<he;E+=2){let ce=D[E],X=D[E+1];ce<M&&(M=ce),X<z&&(z=X),ce>q&&(q=ce),X>V&&(V=X)}}else M=q=z=V=0;G=T[p]={index:p,advanceWidth:U.hmtx.aWidth[p],xMin:M,yMin:z,xMax:q,yMax:V,path:I,pathCommandCount:L.length}}W!==-1&&(N+=l.U.getPairAdjustment(U,W,p)*se),j.call(null,G,N,P),G.advanceWidth&&(N+=G.advanceWidth*se),A&&(N+=A*O),W=p}P+=b.codePointAt(P)>65535?2:1}),N}};return ne}return function(T){const k=new Uint8Array(T,0,4),w=l._bin.readASCII(k,0,4);if(w==="wOFF")T=t(T);else if(w==="wOF2")throw new Error("woff2 fonts not supported");return F(l.parse(T)[0])}}const Ma=xr({name:"Typr Font Parser",dependencies:[Da,Aa,Ea],init(l,t,h){const u=l(),r=t();return h(u,r)}}),ir={defaultFontURL:"https://fonts.gstatic.com/s/roboto/v18/KFOmCnqEu92Fr1Mu4mxM.woff",sdfGlyphSize:64,sdfMargin:1/16,sdfExponent:9,textureWidth:2048},Pa=new Hr;function or(){return(self.performance||Date).now()}const tn=Object.create(null);function gn(l,t){l=Ga({},l);const h=or();if(l.font=Ra(l.font||ir.defaultFontURL),l.text=""+l.text,l.sdfGlyphSize=l.sdfGlyphSize||ir.sdfGlyphSize,l.colorRanges!=null){let f={};for(let c in l.colorRanges)if(l.colorRanges.hasOwnProperty(c)){let d=l.colorRanges[c];typeof d!="number"&&(d=Pa.set(d).getHex()),f[c]=d}l.colorRanges=f}Object.freeze(l);const{textureWidth:u,sdfExponent:r}=ir,{sdfGlyphSize:e}=l,o=u/e*4;let a=tn[e];if(!a){const f=document.createElement("canvas");f.width=u,f.height=e*256/o,a=tn[e]={glyphCount:0,sdfGlyphSize:e,sdfCanvas:f,sdfTexture:new zn(f,void 0,void 0,void 0,Yt,Yt),contextLost:!1,glyphsByFont:new Map},a.sdfTexture.generateMipmaps=!1,Ba(a)}const{sdfTexture:n,sdfCanvas:i}=a;let s=a.glyphsByFont.get(l.font);s||a.glyphsByFont.set(l.font,s=new Map),Ia(l).then(f=>{const{glyphIds:c,glyphPositions:d,fontSize:y,unitsPerEm:m,timings:g}=f,S=[],v=new Float32Array(c.length*4),_=y/m;let F=0,U=0;const T=or();c.forEach((ne,b)=>{let O=s.get(ne);if(!O){const{path:se,pathBounds:ie}=f.glyphData[ne],P=Math.max(ie[2]-ie[0],ie[3]-ie[1])/e*(ir.sdfMargin*e+.5),W=a.glyphCount++,p=[ie[0]-P,ie[1]-P,ie[2]+P,ie[3]+P];s.set(ne,O={path:se,atlasIndex:W,sdfViewBox:p}),S.push(O)}const{sdfViewBox:A}=O,j=d[U++],N=d[U++];v[F++]=j+A[0]*_,v[F++]=N+A[1]*_,v[F++]=j+A[2]*_,v[F++]=N+A[3]*_,c[b]=O.atlasIndex}),g.quads=(g.quads||0)+(or()-T);const k=or();g.sdf={};const w=i.height,Y=Math.ceil(a.glyphCount/o),K=Math.pow(2,Math.ceil(Math.log2(Y*e)));K>w&&(console.info(`Increasing SDF texture size ${w}->${K}`),Ca(i,u,K),n.dispose()),Promise.all(S.map(ne=>mn(ne,a,l.gpuAccelerateSDF).then(({timing:b})=>{g.sdf[ne.atlasIndex]=b}))).then(()=>{S.length&&!a.contextLost&&(yn(a),n.needsUpdate=!0),g.sdfTotal=or()-k,g.total=or()-h,t(Object.freeze({parameters:l,sdfTexture:n,sdfGlyphSize:e,sdfExponent:r,glyphBounds:v,glyphAtlasIndices:c,glyphColors:f.glyphColors,caretPositions:f.caretPositions,caretHeight:f.caretHeight,chunkedBounds:f.chunkedBounds,ascender:f.ascender,descender:f.descender,lineHeight:f.lineHeight,capHeight:f.capHeight,xHeight:f.xHeight,topBaseline:f.topBaseline,blockBounds:f.blockBounds,visibleBounds:f.visibleBounds,timings:f.timings}))})}),Promise.resolve().then(()=>{a.contextLost||Fa(i)})}function mn({path:l,atlasIndex:t,sdfViewBox:h},{sdfGlyphSize:u,sdfCanvas:r,contextLost:e},o){if(e)return Promise.resolve({timing:-1});const{textureWidth:a,sdfExponent:n}=ir,i=Math.max(h[2]-h[0],h[3]-h[1]),s=Math.floor(t/4),f=s%(a/u)*u,c=Math.floor(s/(a/u))*u,d=t%4;return _a(u,u,l,h,i,n,r,f,c,d,o)}function Ba(l){const t=l.sdfCanvas;t.addEventListener("webglcontextlost",h=>{console.log("Context Lost",h),h.preventDefault(),l.contextLost=!0}),t.addEventListener("webglcontextrestored",h=>{console.log("Context Restored",h),l.contextLost=!1;const u=[];l.glyphsByFont.forEach(r=>{r.forEach(e=>{u.push(mn(e,l,!0))})}),Promise.all(u).then(()=>{yn(l),l.sdfTexture.needsUpdate=!0})})}function La({font:l,characters:t,sdfGlyphSize:h},u){let r=Array.isArray(t)?t.join(`
`):""+t;gn({font:l,sdfGlyphSize:h,text:r},u)}function Ga(l,t){for(let h in t)t.hasOwnProperty(h)&&(l[h]=t[h]);return l}let zr;function Ra(l){return zr||(zr=typeof document>"u"?{}:document.createElement("a")),zr.href=l,zr.href}function yn(l){if(typeof createImageBitmap!="function"){console.info("Safari<15: applying SDF canvas workaround");const{sdfCanvas:t,sdfTexture:h}=l,{width:u,height:r}=t,e=l.sdfCanvas.getContext("webgl");let o=h.image.data;(!o||o.length!==u*r*4)&&(o=new Uint8Array(u*r*4),h.image={width:u,height:r,data:o},h.flipY=!1,h.isDataTexture=!0),e.readPixels(0,0,u,r,e.RGBA,e.UNSIGNED_BYTE,o)}}const Oa=xr({name:"Typesetter",dependencies:[ir,Ma,Ua,da],init(l,t,h,u){const{defaultFontURL:r}=l;return h(t,u(),{defaultFontURL:r})}}),Ia=xr({name:"Typesetter",dependencies:[Oa],init(l){return function(t){return new Promise(h=>{l.typeset(t,h)})}},getTransferables(l){const t=[l.glyphPositions.buffer,l.glyphIds.buffer];return l.caretPositions&&t.push(l.caretPositions.buffer),l.glyphColors&&t.push(l.glyphColors.buffer),t}}),nn={};function Wa(l){let t=nn[l];if(!t){const h=new xt(1,1,l,l),u=h.clone(),r=h.attributes,e=u.attributes,o=new cn,a=r.uv.count;for(let n=0;n<a;n++)e.position.array[n*3]*=-1,e.normal.array[n*3+2]*=-1;["position","normal","uv"].forEach(n=>{o.setAttribute(n,new Zn([...r[n].array,...e[n].array],r[n].itemSize))}),o.setIndex([...h.index.array,...u.index.array.map(n=>n+a)]),o.translate(.5,.5,0),t=nn[l]=o}return t}const Na="aTroikaGlyphBounds",an="aTroikaGlyphIndex",za="aTroikaGlyphColor";class Va extends Vn{constructor(){super(),this.detail=1,this.curveRadius=0,this.groups=[{start:0,count:1/0,materialIndex:0},{start:0,count:1/0,materialIndex:1}],this.boundingSphere=new jn,this.boundingBox=new Xn}computeBoundingSphere(){}computeBoundingBox(){}setSide(t){const h=this.getIndex().count;this.setDrawRange(t===Yn?h/2:0,t===un?h:h/2)}set detail(t){if(t!==this._detail){this._detail=t,(typeof t!="number"||t<1)&&(t=1);let h=Wa(t);["position","normal","uv"].forEach(u=>{this.attributes[u]=h.attributes[u].clone()}),this.setIndex(h.getIndex().clone())}}get detail(){return this._detail}set curveRadius(t){t!==this._curveRadius&&(this._curveRadius=t,this._updateBounds())}get curveRadius(){return this._curveRadius}updateGlyphs(t,h,u,r,e){gt(this,Na,t,4),gt(this,an,h,1),gt(this,za,e,3),this._blockBounds=u,this._chunkedBounds=r,this.instanceCount=h.length,this._updateBounds()}_updateBounds(){const t=this._blockBounds;if(t){const{curveRadius:h,boundingBox:u}=this;if(h){const{PI:r,floor:e,min:o,max:a,sin:n,cos:i}=Math,s=r/2,f=r*2,c=Math.abs(h),d=t[0]/c,y=t[2]/c,m=e((d+s)/f)!==e((y+s)/f)?-c:o(n(d)*c,n(y)*c),g=e((d-s)/f)!==e((y-s)/f)?c:a(n(d)*c,n(y)*c),S=e((d+r)/f)!==e((y+r)/f)?c*2:a(c-i(d)*c,c-i(y)*c);u.min.set(m,t[1],h<0?-S:0),u.max.set(g,t[3],h<0?0:S)}else u.min.set(t[0],t[1],0),u.max.set(t[2],t[3],0);u.getBoundingSphere(this.boundingSphere)}}applyClipRect(t){let h=this.getAttribute(an).count,u=this._chunkedBounds;if(u)for(let r=u.length;r--;){h=u[r].end;let e=u[r].rect;if(e[1]<t.w&&e[3]>t.y&&e[0]<t.z&&e[2]>t.x)break}this.instanceCount=h}}function gt(l,t,h,u){const r=l.getAttribute(t);h?r&&r.array.length===h.length?(r.array.set(h),r.needsUpdate=!0):(l.setAttribute(t,new Hn(h,u)),delete l._maxInstanceCount,l.dispose()):r&&l.deleteAttribute(t)}const ja=`
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform vec4 uTroikaTotalBounds;
uniform vec4 uTroikaClipRect;
uniform mat3 uTroikaOrient;
uniform bool uTroikaUseGlyphColors;
uniform float uTroikaDistanceOffset;
uniform float uTroikaBlurRadius;
uniform vec2 uTroikaPositionOffset;
uniform float uTroikaCurveRadius;
attribute vec4 aTroikaGlyphBounds;
attribute float aTroikaGlyphIndex;
attribute vec3 aTroikaGlyphColor;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec3 vTroikaGlyphColor;
varying vec2 vTroikaGlyphDimensions;
`,Xa=`
vec4 bounds = aTroikaGlyphBounds;
bounds.xz += uTroikaPositionOffset.x;
bounds.yw -= uTroikaPositionOffset.y;

vec4 outlineBounds = vec4(
  bounds.xy - uTroikaDistanceOffset - uTroikaBlurRadius,
  bounds.zw + uTroikaDistanceOffset + uTroikaBlurRadius
);
vec4 clippedBounds = vec4(
  clamp(outlineBounds.xy, uTroikaClipRect.xy, uTroikaClipRect.zw),
  clamp(outlineBounds.zw, uTroikaClipRect.xy, uTroikaClipRect.zw)
);

vec2 clippedXY = (mix(clippedBounds.xy, clippedBounds.zw, position.xy) - bounds.xy) / (bounds.zw - bounds.xy);

position.xy = mix(bounds.xy, bounds.zw, clippedXY);

uv = (position.xy - uTroikaTotalBounds.xy) / (uTroikaTotalBounds.zw - uTroikaTotalBounds.xy);

float rad = uTroikaCurveRadius;
if (rad != 0.0) {
  float angle = position.x / rad;
  position.xz = vec2(sin(angle) * rad, rad - cos(angle) * rad);
  normal.xz = vec2(sin(angle), cos(angle));
}
  
position = uTroikaOrient * position;
normal = uTroikaOrient * normal;

vTroikaGlyphUV = clippedXY.xy;
vTroikaGlyphDimensions = vec2(bounds[2] - bounds[0], bounds[3] - bounds[1]);


float txCols = uTroikaSDFTextureSize.x / uTroikaSDFGlyphSize;
vec2 txUvPerSquare = uTroikaSDFGlyphSize / uTroikaSDFTextureSize;
vec2 txStartUV = txUvPerSquare * vec2(
  mod(floor(aTroikaGlyphIndex / 4.0), txCols),
  floor(floor(aTroikaGlyphIndex / 4.0) / txCols)
);
vTroikaTextureUVBounds = vec4(txStartUV, vec2(txStartUV) + txUvPerSquare);
vTroikaTextureChannel = mod(aTroikaGlyphIndex, 4.0);
`,Ya=`
uniform sampler2D uTroikaSDFTexture;
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform float uTroikaSDFExponent;
uniform float uTroikaDistanceOffset;
uniform float uTroikaFillOpacity;
uniform float uTroikaOutlineOpacity;
uniform float uTroikaBlurRadius;
uniform vec3 uTroikaStrokeColor;
uniform float uTroikaStrokeWidth;
uniform float uTroikaStrokeOpacity;
uniform bool uTroikaSDFDebug;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec2 vTroikaGlyphDimensions;

float troikaSdfValueToSignedDistance(float alpha) {
  // Inverse of exponential encoding in webgl-sdf-generator
  
  float maxDimension = max(vTroikaGlyphDimensions.x, vTroikaGlyphDimensions.y);
  float absDist = (1.0 - pow(2.0 * (alpha > 0.5 ? 1.0 - alpha : alpha), 1.0 / uTroikaSDFExponent)) * maxDimension;
  float signedDist = absDist * (alpha > 0.5 ? -1.0 : 1.0);
  return signedDist;
}

float troikaGlyphUvToSdfValue(vec2 glyphUV) {
  vec2 textureUV = mix(vTroikaTextureUVBounds.xy, vTroikaTextureUVBounds.zw, glyphUV);
  vec4 rgba = texture2D(uTroikaSDFTexture, textureUV);
  float ch = floor(vTroikaTextureChannel + 0.5); //NOTE: can't use round() in WebGL1
  return ch == 0.0 ? rgba.r : ch == 1.0 ? rgba.g : ch == 2.0 ? rgba.b : rgba.a;
}

float troikaGlyphUvToDistance(vec2 uv) {
  return troikaSdfValueToSignedDistance(troikaGlyphUvToSdfValue(uv));
}

float troikaGetAADist() {
  
  #if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300
  return length(fwidth(vTroikaGlyphUV * vTroikaGlyphDimensions)) * 0.5;
  #else
  return vTroikaGlyphDimensions.x / 64.0;
  #endif
}

float troikaGetFragDistValue() {
  vec2 clampedGlyphUV = clamp(vTroikaGlyphUV, 0.5 / uTroikaSDFGlyphSize, 1.0 - 0.5 / uTroikaSDFGlyphSize);
  float distance = troikaGlyphUvToDistance(clampedGlyphUV);
 
  // Extrapolate distance when outside bounds:
  distance += clampedGlyphUV == vTroikaGlyphUV ? 0.0 : 
    length((vTroikaGlyphUV - clampedGlyphUV) * vTroikaGlyphDimensions);

  

  return distance;
}

float troikaGetEdgeAlpha(float distance, float distanceOffset, float aaDist) {
  #if defined(IS_DEPTH_MATERIAL) || defined(IS_DISTANCE_MATERIAL)
  float alpha = step(-distanceOffset, -distance);
  #else

  float alpha = smoothstep(
    distanceOffset + aaDist,
    distanceOffset - aaDist,
    distance
  );
  #endif

  return alpha;
}
`,Ha=`
float aaDist = troikaGetAADist();
float fragDistance = troikaGetFragDistValue();
float edgeAlpha = uTroikaSDFDebug ?
  troikaGlyphUvToSdfValue(vTroikaGlyphUV) :
  troikaGetEdgeAlpha(fragDistance, uTroikaDistanceOffset, max(aaDist, uTroikaBlurRadius));

#if !defined(IS_DEPTH_MATERIAL) && !defined(IS_DISTANCE_MATERIAL)
vec4 fillRGBA = gl_FragColor;
fillRGBA.a *= uTroikaFillOpacity;
vec4 strokeRGBA = uTroikaStrokeWidth == 0.0 ? fillRGBA : vec4(uTroikaStrokeColor, uTroikaStrokeOpacity);
if (fillRGBA.a == 0.0) fillRGBA.rgb = strokeRGBA.rgb;
gl_FragColor = mix(fillRGBA, strokeRGBA, smoothstep(
  -uTroikaStrokeWidth - aaDist,
  -uTroikaStrokeWidth + aaDist,
  fragDistance
));
gl_FragColor.a *= edgeAlpha;
#endif

if (edgeAlpha == 0.0) {
  discard;
}
`;function Ja(l){const t=St(l,{chained:!0,extensions:{derivatives:!0},uniforms:{uTroikaSDFTexture:{value:null},uTroikaSDFTextureSize:{value:new Yr},uTroikaSDFGlyphSize:{value:0},uTroikaSDFExponent:{value:0},uTroikaTotalBounds:{value:new Ht(0,0,0,0)},uTroikaClipRect:{value:new Ht(0,0,0,0)},uTroikaDistanceOffset:{value:0},uTroikaOutlineOpacity:{value:0},uTroikaFillOpacity:{value:1},uTroikaPositionOffset:{value:new Yr},uTroikaCurveRadius:{value:0},uTroikaBlurRadius:{value:0},uTroikaStrokeWidth:{value:0},uTroikaStrokeColor:{value:new Hr},uTroikaStrokeOpacity:{value:1},uTroikaOrient:{value:new Jn},uTroikaUseGlyphColors:{value:!0},uTroikaSDFDebug:{value:!1}},vertexDefs:ja,vertexTransform:Xa,fragmentDefs:Ya,fragmentColorTransform:Ha,customRewriter({vertexShader:h,fragmentShader:u}){let r=/\buniform\s+vec3\s+diffuse\b/;return r.test(u)&&(u=u.replace(r,"varying vec3 vTroikaGlyphColor").replace(/\bdiffuse\b/g,"vTroikaGlyphColor"),r.test(h)||(h=h.replace(vn,`uniform vec3 diffuse;
$&
vTroikaGlyphColor = uTroikaUseGlyphColors ? aTroikaGlyphColor / 255.0 : diffuse;
`))),{vertexShader:h,fragmentShader:u}}});return t.transparent=!0,Object.defineProperties(t,{isTroikaTextMaterial:{value:!0},shadowSide:{get(){return this.side},set(){}}}),t}const kt=new Kn({color:16777215,side:un,transparent:!0}),on=8421504,sn=new Qn,Vr=new Jr,mt=new Jr,Sr=[],Ka=new Jr,yt="+x+y";function fn(l){return Array.isArray(l)?l[0]:l}let bn=()=>{const l=new Tt(new xt(1,1),kt);return bn=()=>l,l},Un=()=>{const l=new Tt(new xt(1,1,32,1),kt);return Un=()=>l,l};const Qa={type:"syncstart"},Za={type:"synccomplete"},_n=["font","fontSize","letterSpacing","lineHeight","maxWidth","overflowWrap","text","direction","textAlign","textIndent","whiteSpace","anchorX","anchorY","colorRanges","sdfGlyphSize"],qa=_n.concat("material","color","depthOffset","clipRect","curveRadius","orientation","glyphGeometryDetail");let Sn=class extends Tt{constructor(){const t=new Va;super(t,null),this.text="",this.anchorX=0,this.anchorY=0,this.curveRadius=0,this.direction="auto",this.font=null,this.fontSize=.1,this.letterSpacing=0,this.lineHeight="normal",this.maxWidth=1/0,this.overflowWrap="normal",this.textAlign="left",this.textIndent=0,this.whiteSpace="normal",this.material=null,this.color=null,this.colorRanges=null,this.outlineWidth=0,this.outlineColor=0,this.outlineOpacity=1,this.outlineBlur=0,this.outlineOffsetX=0,this.outlineOffsetY=0,this.strokeWidth=0,this.strokeColor=on,this.strokeOpacity=1,this.fillOpacity=1,this.depthOffset=0,this.clipRect=null,this.orientation=yt,this.glyphGeometryDetail=1,this.sdfGlyphSize=null,this.gpuAccelerateSDF=!0,this.debugSDF=!1}sync(t){this._needsSync&&(this._needsSync=!1,this._isSyncing?(this._queuedSyncs||(this._queuedSyncs=[])).push(t):(this._isSyncing=!0,this.dispatchEvent(Qa),gn({text:this.text,font:this.font,fontSize:this.fontSize||.1,letterSpacing:this.letterSpacing||0,lineHeight:this.lineHeight||"normal",maxWidth:this.maxWidth,direction:this.direction||"auto",textAlign:this.textAlign,textIndent:this.textIndent,whiteSpace:this.whiteSpace,overflowWrap:this.overflowWrap,anchorX:this.anchorX,anchorY:this.anchorY,colorRanges:this.colorRanges,includeCaretPositions:!0,sdfGlyphSize:this.sdfGlyphSize,gpuAccelerateSDF:this.gpuAccelerateSDF},h=>{this._isSyncing=!1,this._textRenderInfo=h,this.geometry.updateGlyphs(h.glyphBounds,h.glyphAtlasIndices,h.blockBounds,h.chunkedBounds,h.glyphColors);const u=this._queuedSyncs;u&&(this._queuedSyncs=null,this._needsSync=!0,this.sync(()=>{u.forEach(r=>r&&r())})),this.dispatchEvent(Za),t&&t()})))}onBeforeRender(t,h,u,r,e,o){this.sync(),e.isTroikaTextMaterial&&this._prepareForRender(e),e._hadOwnSide=e.hasOwnProperty("side"),this.geometry.setSide(e._actualSide=e.side),e.side=Nn}onAfterRender(t,h,u,r,e,o){e._hadOwnSide?e.side=e._actualSide:delete e.side}dispose(){this.geometry.dispose()}get textRenderInfo(){return this._textRenderInfo||null}get material(){let t=this._derivedMaterial;const h=this._baseMaterial||this._defaultMaterial||(this._defaultMaterial=kt.clone());if((!t||t.baseMaterial!==h)&&(t=this._derivedMaterial=Ja(h),h.addEventListener("dispose",function u(){h.removeEventListener("dispose",u),t.dispose()})),this.outlineWidth||this.outlineBlur||this.outlineOffsetX||this.outlineOffsetY){let u=t._outlineMtl;return u||(u=t._outlineMtl=Object.create(t,{id:{value:t.id+.1}}),u.isTextOutlineMaterial=!0,u.depthWrite=!1,u.map=null,t.addEventListener("dispose",function r(){t.removeEventListener("dispose",r),u.dispose()})),[u,t]}else return t}set material(t){t&&t.isTroikaTextMaterial?(this._derivedMaterial=t,this._baseMaterial=t.baseMaterial):this._baseMaterial=t}get glyphGeometryDetail(){return this.geometry.detail}set glyphGeometryDetail(t){this.geometry.detail=t}get curveRadius(){return this.geometry.curveRadius}set curveRadius(t){this.geometry.curveRadius=t}get customDepthMaterial(){return fn(this.material).getDepthMaterial()}get customDistanceMaterial(){return fn(this.material).getDistanceMaterial()}_prepareForRender(t){const h=t.isTextOutlineMaterial,u=t.uniforms,r=this.textRenderInfo;if(r){const{sdfTexture:a,blockBounds:n}=r;u.uTroikaSDFTexture.value=a,u.uTroikaSDFTextureSize.value.set(a.image.width,a.image.height),u.uTroikaSDFGlyphSize.value=r.sdfGlyphSize,u.uTroikaSDFExponent.value=r.sdfExponent,u.uTroikaTotalBounds.value.fromArray(n),u.uTroikaUseGlyphColors.value=!h&&!!r.glyphColors;let i=0,s=0,f=0,c,d,y,m=0,g=0;if(h){let{outlineWidth:v,outlineOffsetX:_,outlineOffsetY:F,outlineBlur:U,outlineOpacity:T}=this;i=this._parsePercent(v)||0,s=Math.max(0,this._parsePercent(U)||0),c=T,m=this._parsePercent(_)||0,g=this._parsePercent(F)||0}else f=Math.max(0,this._parsePercent(this.strokeWidth)||0),f&&(y=this.strokeColor,u.uTroikaStrokeColor.value.set(y??on),d=this.strokeOpacity,d==null&&(d=1)),c=this.fillOpacity;u.uTroikaDistanceOffset.value=i,u.uTroikaPositionOffset.value.set(m,g),u.uTroikaBlurRadius.value=s,u.uTroikaStrokeWidth.value=f,u.uTroikaStrokeOpacity.value=d,u.uTroikaFillOpacity.value=c??1,u.uTroikaCurveRadius.value=this.curveRadius||0;let S=this.clipRect;if(S&&Array.isArray(S)&&S.length===4)u.uTroikaClipRect.value.fromArray(S);else{const v=(this.fontSize||.1)*100;u.uTroikaClipRect.value.set(n[0]-v,n[1]-v,n[2]+v,n[3]+v)}this.geometry.applyClipRect(u.uTroikaClipRect.value)}u.uTroikaSDFDebug.value=!!this.debugSDF,t.polygonOffset=!!this.depthOffset,t.polygonOffsetFactor=t.polygonOffsetUnits=this.depthOffset||0;const e=h?this.outlineColor||0:this.color;if(e==null)delete t.color;else{const a=t.hasOwnProperty("color")?t.color:t.color=new Hr;(e!==a._input||typeof e=="object")&&a.set(a._input=e)}let o=this.orientation||yt;if(o!==t._orientation){let a=u.uTroikaOrient.value;o=o.replace(/[^-+xyz]/g,"");let n=o!==yt&&o.match(/^([-+])([xyz])([-+])([xyz])$/);if(n){let[,i,s,f,c]=n;Vr.set(0,0,0)[s]=i==="-"?1:-1,mt.set(0,0,0)[c]=f==="-"?-1:1,sn.lookAt(Ka,Vr.cross(mt),mt),a.setFromMatrix4(sn)}else a.identity();t._orientation=o}}_parsePercent(t){if(typeof t=="string"){let h=t.match(/^(-?[\d.]+)%$/),u=h?parseFloat(h[1]):NaN;t=(isNaN(u)?0:u/100)*this.fontSize}return t}localPositionToTextCoords(t,h=new Yr){h.copy(t);const u=this.curveRadius;return u&&(h.x=Math.atan2(t.x,Math.abs(u)-Math.abs(t.z))*Math.abs(u)),h}worldPositionToTextCoords(t,h=new Yr){return Vr.copy(t),this.localPositionToTextCoords(this.worldToLocal(Vr),h)}raycast(t,h){const{textRenderInfo:u,curveRadius:r}=this;if(u){const e=u.blockBounds,o=r?Un():bn(),a=o.geometry,{position:n,uv:i}=a.attributes;for(let s=0;s<i.count;s++){let f=e[0]+i.getX(s)*(e[2]-e[0]);const c=e[1]+i.getY(s)*(e[3]-e[1]);let d=0;r&&(d=r-Math.cos(f/r)*r,f=Math.sin(f/r)*r),n.setXYZ(s,f,c,d)}a.boundingSphere=this.geometry.boundingSphere,a.boundingBox=this.geometry.boundingBox,o.matrixWorld=this.matrixWorld,o.material.side=this.material.side,Sr.length=0,o.raycast(t,Sr);for(let s=0;s<Sr.length;s++)Sr[s].object=this,h.push(Sr[s])}}copy(t){const h=this.geometry;return super.copy(t),this.geometry=h,qa.forEach(u=>{this[u]=t[u]}),this}clone(){return new this.constructor().copy(this)}};_n.forEach(l=>{const t="_private_"+l;Object.defineProperty(Sn.prototype,l,{get(){return this[t]},set(h){h!==this[t]&&(this[t]=h,this._needsSync=!0)}})});const $a=Ie.forwardRef(({anchorX:l="center",anchorY:t="middle",font:h,fontSize:u=1,children:r,characters:e,onSync:o,...a},n)=>{const i=qn(({invalidate:d})=>d),[s]=Ie.useState(()=>new Sn),[f,c]=Ie.useMemo(()=>{const d=[];let y="";return Ie.Children.forEach(r,m=>{typeof m=="string"||typeof m=="number"?y+=m:d.push(m)}),[d,y]},[r]);return $n(()=>new Promise(d=>La({font:h,characters:e},d)),["troika-text",h,e]),Ie.useLayoutEffect(()=>void s.sync(()=>{i(),o&&o(s)})),Ie.useEffect(()=>()=>s.dispose(),[s]),Ie.createElement("primitive",ln({object:s,ref:n,font:h,text:c,anchorX:l,anchorY:t,fontSize:u},a),f)});let wn=0;function eo(l){wn=l}function ro(){var l=wn+=1831565813;return l=Math.imul(l^l>>>15,l|1),l^=l+Math.imul(l^l>>>7,l|61),((l^l>>>14)>>>0)/4294967296}function bt(l,t){return t===void 0&&(t=l,l=0),(t-l)*ro()+l|0}function to(){return new Hr(`hsl(${bt(360)}, ${bt(40,70)}%, ${bt(30,60)}%)`)}class no{constructor(t,h){vt(this,"curvesCount");vt(this,"bundles");const u=JSON.parse(t.replace(/^attributes\s*=\s*/,"").replace(/'/g,'"'));this.curvesCount=u.curves_count,this.bundles=[];for(let r=0;r<u.bundles.length;r+=2){const e=u.bundles[r],o=u.bundles[r+1],a=u.bundles[r+3]||u.curves_count;if(typeof e!="string"||typeof o!="number"||typeof a!="number")throw new Error("Unexpected type in bundles definition");this.bundles.push({name:e,start:o,end:a})}this._loadData(h)}_loadData(t){const h=new Int32Array(t),u=new Float32Array(t),r=[];let e=0;for(;e<h.length;){r.push(e);const o=e+1+h[e]*3;if(o<=e)break;e=o}for(const o of this.bundles){const{start:a,end:n}=o,i=r.slice(a,n);if(r.length<=0)continue;const s=i.map(g=>h[g]).reduce((g,S)=>g+S),f=new Float32Array(s*3),c=[];let d=0,y=0;for(const g of i){const S=h[g];f.set(u.subarray(g+1,g+1+S*3),d*3);for(let v=1;v<S;v++)c[y++]=d+v-1,c[y++]=d+v;d+=S}let m=new cn;m.setIndex(c),m.setAttribute("position",new ea(f,3,!0)),m=m.scale(.015,.015,.015).rotateX(Math.PI/2).translate(0,0,-.25).rotateY(Math.PI),m.computeBoundingBox(),o.geometry=m}}}class ao extends ra{constructor(t){super(t)}load(t,h,u,r){const e=new ta(this.manager);e.setPath(this.path),e.setRequestHeader(this.requestHeader),e.setWithCredentials(this.withCredentials),e.setResponseType("text"),e.load(t,o=>{if(typeof o!="string")throw new Error("Unexpected type from FileLoader");e.setResponseType("arraybuffer"),e.load(t+"data",a=>{if(!(a instanceof ArrayBuffer))throw new Error("Unexpected type from FileLoader");h(new no(o,a))},u,r)},u,r)}loadAsync(t,h){return new Promise((u,r)=>{this.load(t,u,h,r)})}}function oo({bundle:l,color:t}){const h=sr(r=>r.selected.length>0),u=sr(r=>r.selected.includes(l.name));return fr("lineSegments",{geometry:l.geometry,children:fr("lineBasicMaterial",{color:t,transparent:!0,opacity:h?u?1:.1:1})})}function io({bundle:l,color:t}){var a;const h=sr(n=>n.toggleSelected),u=sr(n=>n.selected.length>0),r=sr(n=>n.selected.includes(l.name)),[e,o]=Ie.useState(!1);return aa(e),fr(oa,{follow:!0,position:so((a=l.geometry)==null?void 0:a.boundingBox),children:fr($a,{fontSize:.1,color:"#ffffff",outlineColor:t,outlineWidth:.006,fillOpacity:u?r?1:.2:1,outlineOpacity:u?r?1:.2:1,onClick:n=>(n.stopPropagation(),h(l.name)),onPointerEnter:()=>o(!0),onPointerLeave:()=>o(!1),children:l.name})},l.name)}function ho(){const l=na(ao,new URL("./resources/atlas.bundles",window.location.href).href),{setModel:t,setSelected:h}=sr();Ie.useEffect(()=>(t(l),h([]),()=>t(null)),[l]),eo(Mn(r=>r.seed));const u=l.bundles.map(()=>to());return Pn("group",{children:[l.bundles.map((r,e)=>fr(oo,{bundle:r,color:u[e]},r.name)),l.bundles.map((r,e)=>fr(io,{bundle:r,color:u[e]},r.name))]})}function so(l){return l?l.getCenter(new Jr).normalize().multiplyScalar(2):void 0}export{ho as ABrainVis,ho as default};
